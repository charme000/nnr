<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>nnr: Encoder.cpp源文件</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />

<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">nnr
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">异步多客户端通讯库</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- 制作者 Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'搜索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>首页</span></a></li>
      <li><a href="../../annotated.html"><span>类</span></a></li>
      <li class="current"><a href="../../files.html"><span>文件</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="搜索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>文件列表</span></a></li>
      <li><a href="../../globals.html"><span>文件成员</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Encoder.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d8/d08/_encoder_8cpp.html">浏览该文件的文档。</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;<a class="code" href="../../df/d4b/_encoder_8h.html">Encoder.h</a>&quot;</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 
<a name="l00010"></a>00010 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> Encoder::crc16tab[256] = <span class="comment">/* CRC lookup table */</span>
<a name="l00011"></a>00011 {
<a name="l00012"></a>00012     0x0000, 0xC0C1, 0xC181, 0x0140, 0xC301, 0x03C0, 0x0280, 0xC241,
<a name="l00013"></a>00013     0xC601, 0x06C0, 0x0780, 0xC741, 0x0500, 0xC5C1, 0xC481, 0x0440,
<a name="l00014"></a>00014     0xCC01, 0x0CC0, 0x0D80, 0xCD41, 0x0F00, 0xCFC1, 0xCE81, 0x0E40,
<a name="l00015"></a>00015     0x0A00, 0xCAC1, 0xCB81, 0x0B40, 0xC901, 0x09C0, 0x0880, 0xC841,
<a name="l00016"></a>00016     0xD801, 0x18C0, 0x1980, 0xD941, 0x1B00, 0xDBC1, 0xDA81, 0x1A40,
<a name="l00017"></a>00017     0x1E00, 0xDEC1, 0xDF81, 0x1F40, 0xDD01, 0x1DC0, 0x1C80, 0xDC41,
<a name="l00018"></a>00018     0x1400, 0xD4C1, 0xD581, 0x1540, 0xD701, 0x17C0, 0x1680, 0xD641,
<a name="l00019"></a>00019     0xD201, 0x12C0, 0x1380, 0xD341, 0x1100, 0xD1C1, 0xD081, 0x1040,
<a name="l00020"></a>00020     0xF001, 0x30C0, 0x3180, 0xF141, 0x3300, 0xF3C1, 0xF281, 0x3240,
<a name="l00021"></a>00021     0x3600, 0xF6C1, 0xF781, 0x3740, 0xF501, 0x35C0, 0x3480, 0xF441,
<a name="l00022"></a>00022     0x3C00, 0xFCC1, 0xFD81, 0x3D40, 0xFF01, 0x3FC0, 0x3E80, 0xFE41,
<a name="l00023"></a>00023     0xFA01, 0x3AC0, 0x3B80, 0xFB41, 0x3900, 0xF9C1, 0xF881, 0x3840,
<a name="l00024"></a>00024     0x2800, 0xE8C1, 0xE981, 0x2940, 0xEB01, 0x2BC0, 0x2A80, 0xEA41,
<a name="l00025"></a>00025     0xEE01, 0x2EC0, 0x2F80, 0xEF41, 0x2D00, 0xEDC1, 0xEC81, 0x2C40,
<a name="l00026"></a>00026     0xE401, 0x24C0, 0x2580, 0xE541, 0x2700, 0xE7C1, 0xE681, 0x2640,
<a name="l00027"></a>00027     0x2200, 0xE2C1, 0xE381, 0x2340, 0xE101, 0x21C0, 0x2080, 0xE041,
<a name="l00028"></a>00028     0xA001, 0x60C0, 0x6180, 0xA141, 0x6300, 0xA3C1, 0xA281, 0x6240,
<a name="l00029"></a>00029     0x6600, 0xA6C1, 0xA781, 0x6740, 0xA501, 0x65C0, 0x6480, 0xA441,
<a name="l00030"></a>00030     0x6C00, 0xACC1, 0xAD81, 0x6D40, 0xAF01, 0x6FC0, 0x6E80, 0xAE41,
<a name="l00031"></a>00031     0xAA01, 0x6AC0, 0x6B80, 0xAB41, 0x6900, 0xA9C1, 0xA881, 0x6840,
<a name="l00032"></a>00032     0x7800, 0xB8C1, 0xB981, 0x7940, 0xBB01, 0x7BC0, 0x7A80, 0xBA41,
<a name="l00033"></a>00033     0xBE01, 0x7EC0, 0x7F80, 0xBF41, 0x7D00, 0xBDC1, 0xBC81, 0x7C40,
<a name="l00034"></a>00034     0xB401, 0x74C0, 0x7580, 0xB541, 0x7700, 0xB7C1, 0xB681, 0x7640,
<a name="l00035"></a>00035     0x7200, 0xB2C1, 0xB381, 0x7340, 0xB101, 0x71C0, 0x7080, 0xB041,
<a name="l00036"></a>00036     0x5000, 0x90C1, 0x9181, 0x5140, 0x9301, 0x53C0, 0x5280, 0x9241,
<a name="l00037"></a>00037     0x9601, 0x56C0, 0x5780, 0x9741, 0x5500, 0x95C1, 0x9481, 0x5440,
<a name="l00038"></a>00038     0x9C01, 0x5CC0, 0x5D80, 0x9D41, 0x5F00, 0x9FC1, 0x9E81, 0x5E40,
<a name="l00039"></a>00039     0x5A00, 0x9AC1, 0x9B81, 0x5B40, 0x9901, 0x59C0, 0x5880, 0x9841,
<a name="l00040"></a>00040     0x8801, 0x48C0, 0x4980, 0x8941, 0x4B00, 0x8BC1, 0x8A81, 0x4A40,
<a name="l00041"></a>00041     0x4E00, 0x8EC1, 0x8F81, 0x4F40, 0x8D01, 0x4DC0, 0x4C80, 0x8C41,
<a name="l00042"></a>00042     0x4400, 0x84C1, 0x8581, 0x4540, 0x8701, 0x47C0, 0x4680, 0x8641,
<a name="l00043"></a>00043     0x8201, 0x42C0, 0x4380, 0x8341, 0x4100, 0x81C1, 0x8081, 0x4040
<a name="l00044"></a>00044 };
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_alog[256] =
<a name="l00049"></a>00049 {
<a name="l00050"></a>00050     1, 3, 5, 15, 17, 51, 85, 255, 26, 46, 114, 150, 161, 248, 19, 53,
<a name="l00051"></a>00051     95, 225, 56, 72, 216, 115, 149, 164, 247, 2, 6, 10, 30, 34, 102, 170,
<a name="l00052"></a>00052     229, 52, 92, 228, 55, 89, 235, 38, 106, 190, 217, 112, 144, 171, 230, 49,
<a name="l00053"></a>00053     83, 245, 4, 12, 20, 60, 68, 204, 79, 209, 104, 184, 211, 110, 178, 205,
<a name="l00054"></a>00054     76, 212, 103, 169, 224, 59, 77, 215, 98, 166, 241, 8, 24, 40, 120, 136,
<a name="l00055"></a>00055     131, 158, 185, 208, 107, 189, 220, 127, 129, 152, 179, 206, 73, 219, 118, 154,
<a name="l00056"></a>00056     181, 196, 87, 249, 16, 48, 80, 240, 11, 29, 39, 105, 187, 214, 97, 163,
<a name="l00057"></a>00057     254, 25, 43, 125, 135, 146, 173, 236, 47, 113, 147, 174, 233, 32, 96, 160,
<a name="l00058"></a>00058     251, 22, 58, 78, 210, 109, 183, 194, 93, 231, 50, 86, 250, 21, 63, 65,
<a name="l00059"></a>00059     195, 94, 226, 61, 71, 201, 64, 192, 91, 237, 44, 116, 156, 191, 218, 117,
<a name="l00060"></a>00060     159, 186, 213, 100, 172, 239, 42, 126, 130, 157, 188, 223, 122, 142, 137, 128,
<a name="l00061"></a>00061     155, 182, 193, 88, 232, 35, 101, 175, 234, 37, 111, 177, 200, 67, 197, 84,
<a name="l00062"></a>00062     252, 31, 33, 99, 165, 244, 7, 9, 27, 45, 119, 153, 176, 203, 70, 202,
<a name="l00063"></a>00063     69, 207, 74, 222, 121, 139, 134, 145, 168, 227, 62, 66, 198, 81, 243, 14,
<a name="l00064"></a>00064     18, 54, 90, 238, 41, 123, 141, 140, 143, 138, 133, 148, 167, 242, 13, 23,
<a name="l00065"></a>00065     57, 75, 221, 124, 132, 151, 162, 253, 28, 36, 108, 180, 199, 82, 246, 1
<a name="l00066"></a>00066 };
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_log[256] =
<a name="l00069"></a>00069 {
<a name="l00070"></a>00070     0, 0, 25, 1, 50, 2, 26, 198, 75, 199, 27, 104, 51, 238, 223, 3,
<a name="l00071"></a>00071     100, 4, 224, 14, 52, 141, 129, 239, 76, 113, 8, 200, 248, 105, 28, 193,
<a name="l00072"></a>00072     125, 194, 29, 181, 249, 185, 39, 106, 77, 228, 166, 114, 154, 201, 9, 120,
<a name="l00073"></a>00073     101, 47, 138, 5, 33, 15, 225, 36, 18, 240, 130, 69, 53, 147, 218, 142,
<a name="l00074"></a>00074     150, 143, 219, 189, 54, 208, 206, 148, 19, 92, 210, 241, 64, 70, 131, 56,
<a name="l00075"></a>00075     102, 221, 253, 48, 191, 6, 139, 98, 179, 37, 226, 152, 34, 136, 145, 16,
<a name="l00076"></a>00076     126, 110, 72, 195, 163, 182, 30, 66, 58, 107, 40, 84, 250, 133, 61, 186,
<a name="l00077"></a>00077     43, 121, 10, 21, 155, 159, 94, 202, 78, 212, 172, 229, 243, 115, 167, 87,
<a name="l00078"></a>00078     175, 88, 168, 80, 244, 234, 214, 116, 79, 174, 233, 213, 231, 230, 173, 232,
<a name="l00079"></a>00079     44, 215, 117, 122, 235, 22, 11, 245, 89, 203, 95, 176, 156, 169, 81, 160,
<a name="l00080"></a>00080     127, 12, 246, 111, 23, 196, 73, 236, 216, 67, 31, 45, 164, 118, 123, 183,
<a name="l00081"></a>00081     204, 187, 62, 90, 251, 96, 177, 134, 59, 82, 161, 108, 170, 85, 41, 157,
<a name="l00082"></a>00082     151, 178, 135, 144, 97, 190, 220, 252, 188, 149, 207, 205, 55, 63, 91, 209,
<a name="l00083"></a>00083     83, 57, 132, 60, 65, 162, 109, 71, 20, 42, 158, 93, 86, 242, 211, 171,
<a name="l00084"></a>00084     68, 17, 146, 217, 35, 32, 46, 137, 180, 124, 184, 38, 119, 153, 227, 165,
<a name="l00085"></a>00085     103, 74, 237, 222, 197, 49, 254, 24, 13, 99, 140, 128, 192, 247, 112, 7
<a name="l00086"></a>00086 };
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 <span class="keyword">const</span> <span class="keywordtype">char</span> Encoder::sm_S[256] =
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090     99, 124, 119, 123, -14, 107, 111, -59, 48, 1, 103, 43, -2, -41, -85, 118,
<a name="l00091"></a>00091     -54, -126, -55, 125, -6, 89, 71, -16, -83, -44, -94, -81, -100, -92, 114, -64,
<a name="l00092"></a>00092     -73, -3, -109, 38, 54, 63, -9, -52, 52, -91, -27, -15, 113, -40, 49, 21,
<a name="l00093"></a>00093     4, -57, 35, -61, 24, -106, 5, -102, 7, 18, -128, -30, -21, 39, -78, 117,
<a name="l00094"></a>00094     9, -125, 44, 26, 27, 110, 90, -96, 82, 59, -42, -77, 41, -29, 47, -124,
<a name="l00095"></a>00095     83, -47, 0, -19, 32, -4, -79, 91, 106, -53, -66, 57, 74, 76, 88, -49,
<a name="l00096"></a>00096     -48, -17, -86, -5, 67, 77, 51, -123, 69, -7, 2, 127, 80, 60, -97, -88,
<a name="l00097"></a>00097     81, -93, 64, -113, -110, -99, 56, -11, -68, -74, -38, 33, 16, -1, -13, -46,
<a name="l00098"></a>00098     -51, 12, 19, -20, 95, -105, 68, 23, -60, -89, 126, 61, 100, 93, 25, 115,
<a name="l00099"></a>00099     96, -127, 79, -36, 34, 42, -112, -120, 70, -18, -72, 20, -34, 94, 11, -37,
<a name="l00100"></a>00100     -32, 50, 58, 10, 73, 6, 36, 92, -62, -45, -84, 98, -111, -107, -28, 121,
<a name="l00101"></a>00101     -25, -56, 55, 109, -115, -43, 78, -87, 108, 86, -12, -22, 101, 122, -82, 8,
<a name="l00102"></a>00102     -70, 120, 37, 46, 28, -90, -76, -58, -24, -35, 116, 31, 75, -67, -117, -118,
<a name="l00103"></a>00103     112, 62, -75, 102, 72, 3, -10, 14, 97, 53, 87, -71, -122, -63, 29, -98,
<a name="l00104"></a>00104     -31, -8, -104, 17, 105, -39, -114, -108, -101, 30, -121, -23, -50, 85, 40, -33,
<a name="l00105"></a>00105     -116, -95, -119, 13, -65, -26, 66, 104, 65, -103, 45, 15, -80, 84, -69, 22
<a name="l00106"></a>00106 };
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 <span class="keyword">const</span> <span class="keywordtype">char</span> Encoder::sm_Si[256] =
<a name="l00109"></a>00109 {
<a name="l00110"></a>00110     82, 9, 106, -43, 48, 54, -91, 56, -65, 64, -93, -98, -127, -13, -41, -5,
<a name="l00111"></a>00111     124, -29, 57, -126, -101, 47, -1, -121, 52, -114, 67, 68, -60, -34, -23, -53,
<a name="l00112"></a>00112     84, 123, -108, 50, -90, -62, 35, 61, -18, 76, -107, 11, 66, -6, -61, 78,
<a name="l00113"></a>00113     8, 46, -95, 102, 40, -39, 36, -78, 118, 91, -94, 73, 109, -117, -47, 37,
<a name="l00114"></a>00114     114, -8, -10, 100, -122, 104, -104, 22, -44, -92, 92, -52, 93, 101, -74, -110,
<a name="l00115"></a>00115     108, 112, 72, 80, -3, -19, -71, -38, 94, 21, 70, 87, -89, -115, -99, -124,
<a name="l00116"></a>00116     -112, -40, -85, 0, -116, -68, -45, 10, -9, -28, 88, 5, -72, -77, 69, 6,
<a name="l00117"></a>00117     -48, 44, 30, -113, -54, 63, 15, 2, -63, -81, -67, 3, 1, 19, -118, 107,
<a name="l00118"></a>00118     58, -111, 17, 65, 79, 103, -36, -22, -105, -14, -49, -50, -16, -76, -26, 115,
<a name="l00119"></a>00119     -106, -84, 116, 34, -25, -83, 53, -123, -30, -7, 55, -24, 28, 117, -33, 110,
<a name="l00120"></a>00120     71, -15, 26, 113, 29, 41, -59, -119, 111, -73, 98, 14, -86, 24, -66, 27,
<a name="l00121"></a>00121     -4, 86, 62, 75, -58, -46, 121, 32, -102, -37, -64, -2, 120, -51, 90, -12,
<a name="l00122"></a>00122     31, -35, -88, 51, -120, 7, -57, 49, -79, 18, 16, 89, 39, -128, -20, 95,
<a name="l00123"></a>00123     96, 81, 127, -87, 25, -75, 74, 13, 45, -27, 122, -97, -109, -55, -100, -17,
<a name="l00124"></a>00124     -96, -32, 59, 77, -82, 42, -11, -80, -56, -21, -69, 60, -125, 83, -103, 97,
<a name="l00125"></a>00125     23, 43, 4, 126, -70, 119, -42, 38, -31, 105, 20, 99, 85, 33, 12, 125
<a name="l00126"></a>00126 };
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_T1[256] =
<a name="l00129"></a>00129 {
<a name="l00130"></a>00130     -966564955, -126059388, -294160487, -159679603,
<a name="l00131"></a>00131     -855539, -697603139, -563122255, -1849309868,
<a name="l00132"></a>00132     1613770832, 33620227, -832084055, 1445669757,
<a name="l00133"></a>00133     -402719207, -1244145822, 1303096294, -327780710,
<a name="l00134"></a>00134     -1882535355, 528646813, -1983264448, -92439161,
<a name="l00135"></a>00135     -268764651, -1302767125, -1907931191, -68095989,
<a name="l00136"></a>00136     1101901292, -1277897625, 1604494077, 1169141738,
<a name="l00137"></a>00137     597466303, 1403299063, -462261610, -1681866661,
<a name="l00138"></a>00138     1974974402, -503448292, 1033081774, 1277568618,
<a name="l00139"></a>00139     1815492186, 2118074177, -168298750, -2083730353,
<a name="l00140"></a>00140     1748251740, 1369810420, -773462732, -101584632,
<a name="l00141"></a>00141     -495881837, -1411852173, 1647391059, 706024767,
<a name="l00142"></a>00142     134480908, -1782069422, 1176707941, -1648114850,
<a name="l00143"></a>00143     806885416, 932615841, 168101135, 798661301,
<a name="l00144"></a>00144     235341577, 605164086, 461406363, -538779075,
<a name="l00145"></a>00145     -840176858, 1311188841, 2142417613, -361400929,
<a name="l00146"></a>00146     302582043, 495158174, 1479289972, 874125870,
<a name="l00147"></a>00147     907746093, -596742478, -1269146898, 1537253627,
<a name="l00148"></a>00148     -1538108682, 1983593293, -1210657183, 2108928974,
<a name="l00149"></a>00149     1378429307, -572267714, 1580150641, 327451799,
<a name="l00150"></a>00150     -1504488459, -1177431704, 0, -1041371860,
<a name="l00151"></a>00151     1075847264, -469959649, 2041688520, -1235526675,
<a name="l00152"></a>00152     -731223362, -1916023994, 1740553945, 1916352843,
<a name="l00153"></a>00153     -1807070498, -1739830060, -1336387352, -2049978550,
<a name="l00154"></a>00154     -1143943061, -974131414, 1336584933, -302253290,
<a name="l00155"></a>00155     -2042412091, -1706209833, 1714631509, 293963156,
<a name="l00156"></a>00156     -1975171633, -369493744, 67240454, -25198719,
<a name="l00157"></a>00157     -1605349136, 2017213508, 631218106, 1269344483,
<a name="l00158"></a>00158     -1571728909, 1571005438, -2143272768, 93294474,
<a name="l00159"></a>00159     1066570413, 563977660, 1882732616, -235539196,
<a name="l00160"></a>00160     1673313503, 2008463041, -1344611723, 1109467491,
<a name="l00161"></a>00161     537923632, -436207846, -34344178, -1076702611,
<a name="l00162"></a>00162     -2117218996, 403442708, 638784309, -1007883217,
<a name="l00163"></a>00163     -1101045791, 899127202, -2008791860, 773265209,
<a name="l00164"></a>00164     -1815821225, 1437050866, -58818942, 2050833735,
<a name="l00165"></a>00165     -932944724, -1168286233, 840505643, -428641387,
<a name="l00166"></a>00166     -1067425632, 427917720, -1638969391, -1545806721,
<a name="l00167"></a>00167     1143087718, 1412049534, 999329963, 193497219,
<a name="l00168"></a>00168     -1941551414, -940642775, 1807268051, 672404540,
<a name="l00169"></a>00169     -1478566279, -1134666014, 369822493, -1378100362,
<a name="l00170"></a>00170     -606019525, 1681011286, 1949973070, 336202270,
<a name="l00171"></a>00171     -1840690725, 201721354, 1210328172, -1201906460,
<a name="l00172"></a>00172     -1614626211, -1110191250, 1135389935, -1000185178,
<a name="l00173"></a>00173     965841320, 831886756, -739974089, -226920053,
<a name="l00174"></a>00174     -706222286, -1949775805, 1849112409, -630362697,
<a name="l00175"></a>00175     26054028, -1311386268, -1672589614, 1235855840,
<a name="l00176"></a>00176     -663982924, -1403627782, -202050553, -806688219,
<a name="l00177"></a>00177     -899324497, -193299826, 1202630377, 268961816,
<a name="l00178"></a>00178     1874508501, -260540280, 1243948399, 1546530418,
<a name="l00179"></a>00179     941366308, 1470539505, 1941222599, -1748580783,
<a name="l00180"></a>00180     -873928669, -1579295364, -395021156, 1042226977,
<a name="l00181"></a>00181     -1773450275, 1639824860, 227249030, 260737669,
<a name="l00182"></a>00182     -529502064, 2084453954, 1907733956, -865704278,
<a name="l00183"></a>00183     -1874310952, 100860677, -134810111, 470683154,
<a name="l00184"></a>00184     -1033805405, 1781871967, -1370007559, 1773779408,
<a name="l00185"></a>00185     394692241, -1715355304, 974986535, 664706745,
<a name="l00186"></a>00186     -639508168, -336005101, 731420851, 571543859,
<a name="l00187"></a>00187     -764843589, -1445340816, 126783113, 865375399,
<a name="l00188"></a>00188     765172662, 1008606754, 361203602, -907417312,
<a name="l00189"></a>00189     -2016489911, -1437248001, 1344809080, -1512054918,
<a name="l00190"></a>00190     59542671, 1503764984, 160008576, 437062935,
<a name="l00191"></a>00191     1707065306, -672733647, -2076032314, -798463816,
<a name="l00192"></a>00192     -2109652541, 697932208, 1512910199, 504303377,
<a name="l00193"></a>00193     2075177163, -1470868228, 1841019862, 739644986
<a name="l00194"></a>00194 };
<a name="l00195"></a>00195 
<a name="l00196"></a>00196 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_T2[256] =
<a name="l00197"></a>00197 {
<a name="l00198"></a>00198     -1513725085, -2064089988, -1712425097, -1913226373,
<a name="l00199"></a>00199     234877682, -1110021269, -1310822545, 1418839493,
<a name="l00200"></a>00200     1348481072, 50462977, -1446090905, 2102799147,
<a name="l00201"></a>00201     434634494, 1656084439, -431117397, -1695779210,
<a name="l00202"></a>00202     1167051466, -1658879358, 1082771913, -2013627011,
<a name="l00203"></a>00203     368048890, -340633255, -913422521, 201060592,
<a name="l00204"></a>00204     -331240019, 1739838676, -44064094, -364531793,
<a name="l00205"></a>00205     -1088185188, -145513308, -1763413390, 1536934080,
<a name="l00206"></a>00206     -1032472649, 484572669, -1371696237, 1783375398,
<a name="l00207"></a>00207     1517041206, 1098792767, 49674231, 1334037708,
<a name="l00208"></a>00208     1550332980, -195975771, 886171109, 150598129,
<a name="l00209"></a>00209     -1813876367, 1940642008, 1398944049, 1059722517,
<a name="l00210"></a>00210     201851908, 1385547719, 1699095331, 1587397571,
<a name="l00211"></a>00211     674240536, -1590192490, 252314885, -1255171430,
<a name="l00212"></a>00212     151914247, 908333586, -1692696448, 1038082786,
<a name="l00213"></a>00213     651029483, 1766729511, -847269198, -1612024459,
<a name="l00214"></a>00214     454166793, -1642232957, 1951935532, 775166490,
<a name="l00215"></a>00215     758520603, -1294176658, -290170278, -77881184,
<a name="l00216"></a>00216     -157003182, 1299594043, 1639438038, -830622797,
<a name="l00217"></a>00217     2068982057, 1054729187, 1901997871, -1760328572,
<a name="l00218"></a>00218     -173649069, 1757008337, 0, 750906861,
<a name="l00219"></a>00219     1614815264, 535035132, -931548751, -306816165,
<a name="l00220"></a>00220     -1093375382, 1183697867, -647512386, 1265776953,
<a name="l00221"></a>00221     -560706998, -728216500, -391096232, 1250283471,
<a name="l00222"></a>00222     1807470800, 717615087, -447763798, 384695291,
<a name="l00223"></a>00223     -981056701, -677753523, 1432761139, -1810791035,
<a name="l00224"></a>00224     -813021883, 283769337, 100925954, -2114027649,
<a name="l00225"></a>00225     -257929136, 1148730428, -1171939425, -481580888,
<a name="l00226"></a>00226     -207466159, -27417693, -1065336768, -1979347057,
<a name="l00227"></a>00227     -1388342638, -1138647651, 1215313976, 82966005,
<a name="l00228"></a>00228     -547111748, -1049119050, 1974459098, 1665278241,
<a name="l00229"></a>00229     807407632, 451280895, 251524083, 1841287890,
<a name="l00230"></a>00230     1283575245, 337120268, 891687699, 801369324,
<a name="l00231"></a>00231     -507617441, -1573546089, -863484860, 959321879,
<a name="l00232"></a>00232     1469301956, -229267545, -2097381762, 1199193405,
<a name="l00233"></a>00233     -1396153244, -407216803, 724703513, -1780059277,
<a name="l00234"></a>00234     -1598005152, -1743158911, -778154161, 2141445340,
<a name="l00235"></a>00235     1715741218, 2119445034, -1422159728, -2096396152,
<a name="l00236"></a>00236     -896776634, 700968686, -747915080, 1009259540,
<a name="l00237"></a>00237     2041044702, -490971554, 487983883, 1991105499,
<a name="l00238"></a>00238     1004265696, 1449407026, 1316239930, 504629770,
<a name="l00239"></a>00239     -611169975, 168560134, 1816667172, -457679780,
<a name="l00240"></a>00240     1570751170, 1857934291, -280777556, -1497079198,
<a name="l00241"></a>00241     -1472622191, -1540254315, 936633572, -1947043463,
<a name="l00242"></a>00242     852879335, 1133234376, 1500395319, -1210421907,
<a name="l00243"></a>00243     -1946055283, 1689376213, -761508274, -532043351,
<a name="l00244"></a>00244     -1260884884, -89369002, 133428468, 634383082,
<a name="l00245"></a>00245     -1345690267, -1896580486, -381178194, 403703816,
<a name="l00246"></a>00246     -714097990, -1997506440, 1867130149, 1918643758,
<a name="l00247"></a>00247     607656988, -245913946, -948718412, 1368901318,
<a name="l00248"></a>00248     600565992, 2090982877, -1662487436, 557719327,
<a name="l00249"></a>00249     -577352885, -597574211, -2045932661, -2062579062,
<a name="l00250"></a>00250     -1864339344, 1115438654, -999180875, -1429445018,
<a name="l00251"></a>00251     -661632952, 84280067, 33027830, 303828494,
<a name="l00252"></a>00252     -1547542175, 1600795957, -106014889, -798377543,
<a name="l00253"></a>00253     -1860729210, 1486471617, 658119965, -1188585826,
<a name="l00254"></a>00254     953803233, 334231800, -1288988520, 857870609,
<a name="l00255"></a>00255     -1143838359, 1890179545, -1995993458, -1489791852,
<a name="l00256"></a>00256     -1238525029, 574365214, -1844082809, 550103529,
<a name="l00257"></a>00257     1233637070, -5614251, 2018519080, 2057691103,
<a name="l00258"></a>00258     -1895592820, -128343647, -2146858615, 387583245,
<a name="l00259"></a>00259     -630865985, 836232934, -964410814, -1194301336,
<a name="l00260"></a>00260     -1014873791, -1339450983, 2002398509, 287182607,
<a name="l00261"></a>00261     -881086288, -56077228, -697451589, 975967766
<a name="l00262"></a>00262 };
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_T3[256] =
<a name="l00265"></a>00265 {
<a name="l00266"></a>00266     1671808611, 2089089148, 2006576759, 2072901243,
<a name="l00267"></a>00267     -233963534, 1807603307, 1873927791, -984313403,
<a name="l00268"></a>00268     810573872, 16974337, 1739181671, 729634347,
<a name="l00269"></a>00269     -31856642, -681396777, -1410970197, 1989864566,
<a name="l00270"></a>00270     -901410870, -2103631998, -918517303, 2106063485,
<a name="l00271"></a>00271     -99225606, 1508618841, 1204391495, -267650064,
<a name="l00272"></a>00272     -1377025619, -731401260, -1560453214, -1343601233,
<a name="l00273"></a>00273     -1665195108, -1527295068, 1922491506, -1067738176,
<a name="l00274"></a>00274     -1211992649, -48438787, -1817297517, 644500518,
<a name="l00275"></a>00275     911895606, 1061256767, -150800905, -867204148,
<a name="l00276"></a>00276     878471220, -1510714971, -449523227, -251069967,
<a name="l00277"></a>00277     1905517169, -663508008, 827548209, 356461077,
<a name="l00278"></a>00278     67897348, -950889017, 593839651, -1017209405,
<a name="l00279"></a>00279     405286936, -1767819370, 84871685, -1699401830,
<a name="l00280"></a>00280     118033927, 305538066, -2137318528, -499261470,
<a name="l00281"></a>00281     -349778453, 661212711, -1295155278, 1973414517,
<a name="l00282"></a>00282     152769033, -2086789757, 745822252, 439235610,
<a name="l00283"></a>00283     455947803, 1857215598, 1525593178, -1594139744,
<a name="l00284"></a>00284     1391895634, 994932283, -698239018, -1278313037,
<a name="l00285"></a>00285     695947817, -482419229, 795958831, -2070473852,
<a name="l00286"></a>00286     1408607827, -781665839, 0, -315833875,
<a name="l00287"></a>00287     543178784, -65018884, -1312261711, 1542305371,
<a name="l00288"></a>00288     1790891114, -884568629, -1093048386, 961245753,
<a name="l00289"></a>00289     1256100938, 1289001036, 1491644504, -817199665,
<a name="l00290"></a>00290     -798245936, -282409489, -1427812438, -82383365,
<a name="l00291"></a>00291     1137018435, 1305975373, 861234739, -2053893755,
<a name="l00292"></a>00292     1171229253, -116332039, 33948674, 2139225727,
<a name="l00293"></a>00293     1357946960, 1011120188, -1615190625, -1461498968,
<a name="l00294"></a>00294     1374921297, -1543610973, 1086357568, -1886780017,
<a name="l00295"></a>00295     -1834139758, -1648615011, 944271416, -184225291,
<a name="l00296"></a>00296     -1126210628, -1228834890, -629821478, 560153121,
<a name="l00297"></a>00297     271589392, -15014401, -217121293, -764559406,
<a name="l00298"></a>00298     -850624051, 202643468, 322250259, -332413972,
<a name="l00299"></a>00299     1608629855, -1750977129, 1154254916, 389623319,
<a name="l00300"></a>00300     -1000893500, -1477290585, 2122513534, 1028094525,
<a name="l00301"></a>00301     1689045092, 1575467613, 422261273, 1939203699,
<a name="l00302"></a>00302     1621147744, -2120738431, 1339137615, -595614756,
<a name="l00303"></a>00303     577127458, 712922154, -1867826288, -2004677752,
<a name="l00304"></a>00304     1187679302, -299251730, -1194103880, 339486740,
<a name="l00305"></a>00305     -562452514, 1591917662, 186455563, -612979237,
<a name="l00306"></a>00306     -532948000, 844522546, 978220090, 169743370,
<a name="l00307"></a>00307     1239126601, 101321734, 611076132, 1558493276,
<a name="l00308"></a>00308     -1034051646, -747717165, -1393605716, 1655096418,
<a name="l00309"></a>00309     -1851246191, -1784401515, -466103324, 2039214713,
<a name="l00310"></a>00310     -416098841, -935097400, 928607799, 1840765549,
<a name="l00311"></a>00311     -1920204403, -714821163, 1322425422, -1444918871,
<a name="l00312"></a>00312     1823791212, 1459268694, -200805388, -366620694,
<a name="l00313"></a>00313     1706019429, 2056189050, -1360443474, 135794696,
<a name="l00314"></a>00314     -1160417350, 2022240376, 628050469, 779246638,
<a name="l00315"></a>00315     472135708, -1494132826, -1261997132, -967731258,
<a name="l00316"></a>00316     -400307224, -579034659, 1956440180, 522272287,
<a name="l00317"></a>00317     1272813131, -1109630531, -1954148981, -1970991222,
<a name="l00318"></a>00318     1888542832, 1044544574, -1245417035, 1722469478,
<a name="l00319"></a>00319     1222152264, 50660867, -167643146, 236067854,
<a name="l00320"></a>00320     1638122081, 895445557, 1475980887, -1177523783,
<a name="l00321"></a>00321     -2037311610, -1051158079, 489110045, -1632032866,
<a name="l00322"></a>00322     -516367903, -132912136, -1733088360, 288563729,
<a name="l00323"></a>00323     1773916777, -646927911, -1903622258, -1800981612,
<a name="l00324"></a>00324     -1682559589, 505560094, -2020469369, -383727127,
<a name="l00325"></a>00325     -834041906, 1442818645, 678973480, -545610273,
<a name="l00326"></a>00326     -1936784500, -1577559647, -1988097655, 219617805,
<a name="l00327"></a>00327     -1076206145, -432941082, 1120306242, 1756942440,
<a name="l00328"></a>00328     1103331905, -1716508263, 762796589, 252780047,
<a name="l00329"></a>00329     -1328841808, 1425844308, -1143575109, 372911126
<a name="l00330"></a>00330 };
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_T4[256] =
<a name="l00333"></a>00333 {
<a name="l00334"></a>00334     1667474886, 2088535288, 2004326894, 2071694838,
<a name="l00335"></a>00335     -219017729, 1802223062, 1869591006, -976923503,
<a name="l00336"></a>00336     808472672, 16843522, 1734846926, 724270422,
<a name="l00337"></a>00337     -16901657, -673750347, -1414797747, 1987484396,
<a name="l00338"></a>00338     -892713585, -2105369313, -909557623, 2105378810,
<a name="l00339"></a>00339     -84273681, 1499065266, 1195886990, -252703749,
<a name="l00340"></a>00340     -1381110719, -724277325, -1566376609, -1347425723,
<a name="l00341"></a>00341     -1667449053, -1532692653, 1920112356, -1061135461,
<a name="l00342"></a>00342     -1212693899, -33743647, -1819038147, 640051788,
<a name="l00343"></a>00343     909531756, 1061110142, -134806795, -859025533,
<a name="l00344"></a>00344     875846760, -1515850671, -437963567, -235861767,
<a name="l00345"></a>00345     1903268834, -656903253, 825316194, 353713962,
<a name="l00346"></a>00346     67374088, -943238507, 589522246, -1010606435,
<a name="l00347"></a>00347     404236336, -1768513225, 84217610, -1701137105,
<a name="l00348"></a>00348     117901582, 303183396, -2139055333, -488489505,
<a name="l00349"></a>00349     -336910643, 656894286, -1296904833, 1970642922,
<a name="l00350"></a>00350     151591698, -2088526307, 741110872, 437923380,
<a name="l00351"></a>00351     454765878, 1852748508, 1515908788, -1600062629,
<a name="l00352"></a>00352     1381168804, 993742198, -690593353, -1280061827,
<a name="l00353"></a>00353     690584402, -471646499, 791638366, -2071685357,
<a name="l00354"></a>00354     1398011302, -774805319, 0, -303223615,
<a name="l00355"></a>00355     538992704, -50585629, -1313748871, 1532751286,
<a name="l00356"></a>00356     1785380564, -875870579, -1094788761, 960056178,
<a name="l00357"></a>00357     1246420628, 1280103576, 1482221744, -808498555,
<a name="l00358"></a>00358     -791647301, -269538619, -1431640753, -67430675,
<a name="l00359"></a>00359     1128514950, 1296947098, 859002214, -2054843375,
<a name="l00360"></a>00360     1162203018, -101117719, 33687044, 2139062782,
<a name="l00361"></a>00361     1347481760, 1010582648, -1616922075, -1465326773,
<a name="l00362"></a>00362     1364325282, -1549533603, 1077985408, -1886418427,
<a name="l00363"></a>00363     -1835881153, -1650607071, 943212656, -168491791,
<a name="l00364"></a>00364     -1128472733, -1229536905, -623217233, 555836226,
<a name="l00365"></a>00365     269496352, -58651, -202174723, -757961281,
<a name="l00366"></a>00366     -842183551, 202118168, 320025894, -320065597,
<a name="l00367"></a>00367     1600119230, -1751670219, 1145359496, 387397934,
<a name="l00368"></a>00368     -993765485, -1482165675, 2122220284, 1027426170,
<a name="l00369"></a>00369     1684319432, 1566435258, 421079858, 1936954854,
<a name="l00370"></a>00370     1616945344, -2122213351, 1330631070, -589529181,
<a name="l00371"></a>00371     572679748, 707427924, -1869567173, -2004319477,
<a name="l00372"></a>00372     1179044492, -286381625, -1195846805, 336870440,
<a name="l00373"></a>00373     -555845209, 1583276732, 185277718, -606374227,
<a name="l00374"></a>00374     -522175525, 842159716, 976899700, 168435220,
<a name="l00375"></a>00375     1229577106, 101059084, 606366792, 1549591736,
<a name="l00376"></a>00376     -1027449441, -741118275, -1397952701, 1650632388,
<a name="l00377"></a>00377     -1852725191, -1785355215, -454805549, 2038008818,
<a name="l00378"></a>00378     -404278571, -926399605, 926374254, 1835907034,
<a name="l00379"></a>00379     -1920103423, -707435343, 1313788572, -1448484791,
<a name="l00380"></a>00380     1819063512, 1448540844, -185333773, -353753649,
<a name="l00381"></a>00381     1701162954, 2054852340, -1364268729, 134748176,
<a name="l00382"></a>00382     -1162160785, 2021165296, 623210314, 774795868,
<a name="l00383"></a>00383     471606328, -1499008681, -1263220877, -960081513,
<a name="l00384"></a>00384     -387439669, -572687199, 1953799400, 522133822,
<a name="l00385"></a>00385     1263263126, -1111630751, -1953790451, -1970633457,
<a name="l00386"></a>00386     1886425312, 1044267644, -1246378895, 1718004428,
<a name="l00387"></a>00387     1212733584, 50529542, -151649801, 235803164,
<a name="l00388"></a>00388     1633788866, 892690282, 1465383342, -1179004823,
<a name="l00389"></a>00389     -2038001385, -1044293479, 488449850, -1633765081,
<a name="l00390"></a>00390     -505333543, -117959701, -1734823125, 286339874,
<a name="l00391"></a>00391     1768537042, -640061271, -1903261433, -1802197197,
<a name="l00392"></a>00392     -1684294099, 505291324, -2021158379, -370597687,
<a name="l00393"></a>00393     -825341561, 1431699370, 673740880, -539002203,
<a name="l00394"></a>00394     -1936945405, -1583220647, -1987477495, 218961690,
<a name="l00395"></a>00395     -1077945755, -421121577, 1111672452, 1751693520,
<a name="l00396"></a>00396     1094828930, -1717981143, 757954394, 252645662,
<a name="l00397"></a>00397     -1330590853, 1414855848, -1145317779, 370555436
<a name="l00398"></a>00398 };
<a name="l00399"></a>00399 
<a name="l00400"></a>00400 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_T5[256] =
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402     1374988112, 2118214995, 437757123, 975658646,
<a name="l00403"></a>00403     1001089995, 530400753, -1392879445, 1273168787,
<a name="l00404"></a>00404     540080725, -1384747530, -1999866223, -184398811,
<a name="l00405"></a>00405     1340463100, -987051049, 641025152, -1251826801,
<a name="l00406"></a>00406     -558802359, 632953703, 1172967064, 1576976609,
<a name="l00407"></a>00407     -1020300030, -2125664238, -1924753501, 1809054150,
<a name="l00408"></a>00408     59727847, 361929877, -1083344149, -1789765158,
<a name="l00409"></a>00409     -725712083, 1484005843, 1239443753, -1899378620,
<a name="l00410"></a>00410     1975683434, -191989384, -1722270101, 666464733,
<a name="l00411"></a>00411     -1092530250, -259478249, -920605594, 2110667444,
<a name="l00412"></a>00412     1675577880, -451268222, -1756286112, 1649639237,
<a name="l00413"></a>00413     -1318815776, -1150570876, -25059300, -116905068,
<a name="l00414"></a>00414     1883793496, -1891238631, -1797362553, 1383856311,
<a name="l00415"></a>00415     -1418472669, 1917518562, -484470953, 1716890410,
<a name="l00416"></a>00416     -1293211641, 800440835, -2033878118, -751368027,
<a name="l00417"></a>00417     807962610, 599762354, 33778362, -317291940,
<a name="l00418"></a>00418     -1966138325, -1485196142, -217582864, 1315562145,
<a name="l00419"></a>00419     1708848333, 101039829, -785096161, -995688822,
<a name="l00420"></a>00420     875451293, -1561111136, 92987698, -1527321739,
<a name="l00421"></a>00421     193195065, 1080094634, 1584504582, -1116860335,
<a name="l00422"></a>00422     1042385657, -1763899843, -583137874, 1306967366,
<a name="l00423"></a>00423     -1856729675, 1908694277, 67556463, 1615861247,
<a name="l00424"></a>00424     429456164, -692196969, -1992277044, 1742315127,
<a name="l00425"></a>00425     -1326955843, 126454664, -417768648, 2043211483,
<a name="l00426"></a>00426     -1585706425, 2084704233, -125559095, 0,
<a name="l00427"></a>00427     159417987, 841739592, 504459436, 1817866830,
<a name="l00428"></a>00428     -49348613, 260388950, 1034867998, 908933415,
<a name="l00429"></a>00429     168810852, 1750902305, -1688513327, 607530554,
<a name="l00430"></a>00430     202008497, -1822955761, -1259432238, 463180190,
<a name="l00431"></a>00431     -2134850225, 1641816226, 1517767529, 470948374,
<a name="l00432"></a>00432     -493635062, -1063245083, 1008918595, 303765277,
<a name="l00433"></a>00433     235474187, -225720403, 766945465, 337553864,
<a name="l00434"></a>00434     1475418501, -1351284916, -291906117, -1551933187,
<a name="l00435"></a>00435     -150919521, 1551037884, 1147550661, 1543208500,
<a name="l00436"></a>00436     -1958532746, -886847780, -1225917336, -1192955549,
<a name="l00437"></a>00437     -684598070, 1113818384, 328671808, -2067394272,
<a name="l00438"></a>00438     -2058738563, -759480840, -1359400431, -953573011,
<a name="l00439"></a>00439     496906059, -592301837, 226906860, 2009195472,
<a name="l00440"></a>00440     733156972, -1452230247, 294930682, 1206477858,
<a name="l00441"></a>00441     -1459843900, -1594867942, 1451044056, 573804783,
<a name="l00442"></a>00442     -2025238841, -650587711, -1932877058, -1730933962,
<a name="l00443"></a>00443     -1493859889, -1518674392, -625504730, 1068351396,
<a name="l00444"></a>00444     742039012, 1350078989, 1784663195, 1417561698,
<a name="l00445"></a>00445     -158526526, -1864845080, 775550814, -2101104651,
<a name="l00446"></a>00446     -1621262146, 1775276924, 1876241833, -819653965,
<a name="l00447"></a>00447     -928212677, 270040487, -392404114, -616842373,
<a name="l00448"></a>00448     -853116919, 1851332852, -325404927, -2091935064,
<a name="l00449"></a>00449     -426414491, -1426069890, 566021896, -283776794,
<a name="l00450"></a>00450     -1159226407, 1248802510, -358676012, 699432150,
<a name="l00451"></a>00451     832877231, 708780849, -962227152, 899835584,
<a name="l00452"></a>00452     1951317047, -58537306, -527380304, 866637845,
<a name="l00453"></a>00453     -251357110, 1106041591, 2144161806, 395441711,
<a name="l00454"></a>00454     1984812685, 1139781709, -861254316, -459930401,
<a name="l00455"></a>00455     -1630423581, 1282050075, -1054072904, 1181045119,
<a name="l00456"></a>00456     -1654724092, 25965917, -91786125, -83148498,
<a name="l00457"></a>00457     -1285087910, -1831087534, -384805325, 1842759443,
<a name="l00458"></a>00458     -1697160820, 933301370, 1509430414, -351060855,
<a name="l00459"></a>00459     -827774994, -1218328267, -518199827, 2051518780,
<a name="l00460"></a>00460     -1663901863, 1441952575, 404016761, 1942435775,
<a name="l00461"></a>00461     1408749034, 1610459739, -549621996, 2017778566,
<a name="l00462"></a>00462     -894438527, -1184316354, 941896748, -1029488545,
<a name="l00463"></a>00463     371049330, -1126030068, 675039627, -15887039,
<a name="l00464"></a>00464     967311729, 135050206, -659233636, 1683407248,
<a name="l00465"></a>00465     2076935265, -718096784, 1215061108, -793225406
<a name="l00466"></a>00466 };
<a name="l00467"></a>00467 
<a name="l00468"></a>00468 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_T6[256] =
<a name="l00469"></a>00469 {
<a name="l00470"></a>00470     1347548327, 1400783205, -1021700188, -1774573730,
<a name="l00471"></a>00471     -885281941, -249586363, -1414727080, -1823743229,
<a name="l00472"></a>00472     1428173050, -156404115, -1853305738, 636813900,
<a name="l00473"></a>00473     -61872681, -674944309, -2144979644, -1883938141,
<a name="l00474"></a>00474     1239331162, 1730525723, -1740248562, -513933632,
<a name="l00475"></a>00475     46346101, 310463728, -1551022441, -966011911,
<a name="l00476"></a>00476     -419197089, -1793748324, -339776134, -627748263,
<a name="l00477"></a>00477     768917123, -749177823, 692707433, 1150208456,
<a name="l00478"></a>00478     1786102409, 2029293177, 1805211710, -584599183,
<a name="l00479"></a>00479     -1229004465, 401639597, 1724457132, -1266823622,
<a name="l00480"></a>00480     409198410, -2098914767, 1620529459, 1164071807,
<a name="l00481"></a>00481     -525245321, -2068091986, 486441376, -1795618773,
<a name="l00482"></a>00482     1483753576, 428819965, -2020286868, -1219331080,
<a name="l00483"></a>00483     598438867, -495826174, 1474502543, 711349675,
<a name="l00484"></a>00484     129166120, 53458370, -1702443653, -1512884472,
<a name="l00485"></a>00485     -231724921, -1306280027, -1174273174, 1559041666,
<a name="l00486"></a>00486     730517276, -1834518092, -252508174, -1588696606,
<a name="l00487"></a>00487     -848962828, -721025602, 533804130, -1966823682,
<a name="l00488"></a>00488     -1657524653, -1599933611, 839224033, 1973745387,
<a name="l00489"></a>00489     957055980, -1438621457, 106852767, 1371368976,
<a name="l00490"></a>00490     -113368694, 1033297158, -1361232379, 1179510461,
<a name="l00491"></a>00491     -1248766835, 91341917, 1862534868, -10465259,
<a name="l00492"></a>00492     605657339, -1747534359, -863420349, 2003294622,
<a name="l00493"></a>00493     -1112479678, -2012771957, 954669403, -612775698,
<a name="l00494"></a>00494     1201765386, -377732593, -906460130, 0,
<a name="l00495"></a>00495     -2096529274, 1211247597, -1407315600, 1315723890,
<a name="l00496"></a>00496     -67301633, 1443857720, 507358933, 657861945,
<a name="l00497"></a>00497     1678381017, 560487590, -778347692, 975451694,
<a name="l00498"></a>00498     -1324610969, 261314535, -759894378, -1642357871,
<a name="l00499"></a>00499     1333838021, -1570644960, 1767536459, 370938394,
<a name="l00500"></a>00500     182621114, -440360918, 1128014560, 487725847,
<a name="l00501"></a>00501     185469197, -1376613433, -1188186456, -938205527,
<a name="l00502"></a>00502     -2057834215, 1286567175, -1141990947, -39616672,
<a name="l00503"></a>00503     -1611202266, -1134791947, -985373125, 878443390,
<a name="l00504"></a>00504     1988838185, -590666810, 1756818940, 1673061617,
<a name="l00505"></a>00505     -891866660, 272786309, 1075025698, 545572369,
<a name="l00506"></a>00506     2105887268, -120407235, 296679730, 1841768865,
<a name="l00507"></a>00507     1260232239, -203640272, -334657966, -797457949,
<a name="l00508"></a>00508     1814803222, -1716948807, -99511224, 575138148,
<a name="l00509"></a>00509     -995558260, 446754879, -665420500, -282971248,
<a name="l00510"></a>00510     -947435186, -1042728751, -24327518, 915985419,
<a name="l00511"></a>00511     -811141759, 681933534, 651868046, -1539330625,
<a name="l00512"></a>00512     -466863459, 223377554, -1687527476, 1649704518,
<a name="l00513"></a>00513     -1024029421, -393160520, 1580087799, -175979601,
<a name="l00514"></a>00514     -1096852096, 2087309459, -1452288723, -1278270190,
<a name="l00515"></a>00515     1003007129, -1492117379, 1860738147, 2077965243,
<a name="l00516"></a>00516     164439672, -194094824, 32283319, -1467789414,
<a name="l00517"></a>00517     1709610350, 2125135846, 136428751, -420538904,
<a name="l00518"></a>00518     -642062437, -833982666, -722821367, -701910916,
<a name="l00519"></a>00519     -1355701070, 824852259, 818324884, -1070226842,
<a name="l00520"></a>00520     930369212, -1493400886, -1327460144, 355706840,
<a name="l00521"></a>00521     1257309336, -146674470, 243256656, 790073846,
<a name="l00522"></a>00522     -1921626666, 1296297904, 1422699085, -538667516,
<a name="l00523"></a>00523     -476130891, 457992840, -1195299809, 2135319889,
<a name="l00524"></a>00524     77422314, 1560382517, 1945798516, 788204353,
<a name="l00525"></a>00525     1521706781, 1385356242, 870912086, 325965383,
<a name="l00526"></a>00526     -1936009375, 2050466060, -1906706412, -1981082820,
<a name="l00527"></a>00527     -288446169, 901210569, -304014107, 1014646705,
<a name="l00528"></a>00528     1503449823, 1062597235, 2031621326, -1082931401,
<a name="l00529"></a>00529     -363595827, 1533017514, 350174575, -2038938405,
<a name="l00530"></a>00530     -2117423117, 1052338372, 741876788, 1606591296,
<a name="l00531"></a>00531     1914052035, 213705253, -1960297399, 1107234197,
<a name="l00532"></a>00532     1899603969, -569897805, -1663519516, -1872472383,
<a name="l00533"></a>00533     1635502980, 1893020342, 1950903388, 1120974935
<a name="l00534"></a>00534 };
<a name="l00535"></a>00535 
<a name="l00536"></a>00536 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_T7[256] =
<a name="l00537"></a>00537 {
<a name="l00538"></a>00538     -1487908364, 1699970625, -1530717673, 1586903591,
<a name="l00539"></a>00539     1808481195, 1173430173, 1487645946, 59984867,
<a name="l00540"></a>00540     -95084496, 1844882806, 1989249228, 1277555970,
<a name="l00541"></a>00541     -671330331, -875051734, 1149249077, -1550863006,
<a name="l00542"></a>00542     1514790577, 459744698, 244860394, -1058972162,
<a name="l00543"></a>00543     1963115311, -267222708, -1750889146, -104436781,
<a name="l00544"></a>00544     1608975247, -1667951214, 2062270317, 1507497298,
<a name="l00545"></a>00545     -2094148418, 567498868, 1764313568, -935031095,
<a name="l00546"></a>00546     -1989511742, 2037970062, 1047239000, 1910319033,
<a name="l00547"></a>00547     1337376481, -1390940024, -1402549984, 984907214,
<a name="l00548"></a>00548     1243112415, 830661914, 861968209, 2135253587,
<a name="l00549"></a>00549     2011214180, -1367032981, -1608712575, 731183368,
<a name="l00550"></a>00550     1750626376, -48656571, 1820824798, -122203525,
<a name="l00551"></a>00551     -752637069, 48394827, -1890065633, -1423284651,
<a name="l00552"></a>00552     671593195, -1039978571, 2073724613, 145085239,
<a name="l00553"></a>00553     -2014171096, -1515052097, 1790575107, -2107839210,
<a name="l00554"></a>00554     472615631, -1265457287, -219090169, -492745111,
<a name="l00555"></a>00555     -187865638, -1093335547, 1646252340, -24460122,
<a name="l00556"></a>00556     1402811438, 1436590835, -516815478, -344611594,
<a name="l00557"></a>00557     -331805821, -274055072, -1626972559, 273792366,
<a name="l00558"></a>00558     -1963377119, 104699613, 95345982, -1119466010,
<a name="l00559"></a>00559     -1917480620, 1560637892, -730921978, 369057872,
<a name="l00560"></a>00560     -81520232, -375925059, 1137477952, -1636341799,
<a name="l00561"></a>00561     1119727848, -1954019447, 1530455833, -287606328,
<a name="l00562"></a>00562     172466556, 266959938, 516552836, 0,
<a name="l00563"></a>00563     -2038232704, -314035669, 1890328081, 1917742170,
<a name="l00564"></a>00564     -262898, 945164165, -719438418, 958871085,
<a name="l00565"></a>00565     -647755249, -1507760036, 1423022939, 775562294,
<a name="l00566"></a>00566     1739656202, -418409641, -1764576018, -1851909221,
<a name="l00567"></a>00567     -984645440, 547512796, 1265195639, 437656594,
<a name="l00568"></a>00568     -1173691757, 719700128, -532464606, 387781147,
<a name="l00569"></a>00569     218828297, -944901493, -1464259146, -1446505442,
<a name="l00570"></a>00570     428169201, 122466165, -574886247, 1627235199,
<a name="l00571"></a>00571     648017665, -172204942, 1002783846, 2117360635,
<a name="l00572"></a>00572     695634755, -958608605, -60246291, -245122844,
<a name="l00573"></a>00573     -590686415, -2062531997, 574624663, 287343814,
<a name="l00574"></a>00574     612205898, 1039717051, 840019705, -1586641111,
<a name="l00575"></a>00575     793451934, 821288114, 1391201670, -472877119,
<a name="l00576"></a>00576     376187827, -1181111952, 1224348052, 1679968233,
<a name="l00577"></a>00577     -1933268740, 1058709744, 752375421, -1863376333,
<a name="l00578"></a>00578     1321699145, -775825096, -1560376118, 188127444,
<a name="l00579"></a>00579     -2117097739, -567761542, -1910056265, -1079754835,
<a name="l00580"></a>00580     -1645990854, -1844621192, -862229921, 1180849278,
<a name="l00581"></a>00581     331544205, -1192718120, -144822727, -1342864701,
<a name="l00582"></a>00582     -2134991011, -1820562992, 766078933, 313773861,
<a name="l00583"></a>00583     -1724135252, 2108100632, 1668212892, -1149510853,
<a name="l00584"></a>00584     2013908262, 418672217, -1224610662, -1700232369,
<a name="l00585"></a>00585     1852171925, -427906305, -821550660, -387518699,
<a name="l00586"></a>00586     -1680229657, 919489135, 164948639, 2094410160,
<a name="l00587"></a>00587     -1297141340, 590424639, -1808742747, 1723872674,
<a name="l00588"></a>00588     -1137216434, -895026046, -793714544, -669699161,
<a name="l00589"></a>00589     -1739919100, -621329940, 1343127501, -164685935,
<a name="l00590"></a>00590     -695372211, -1337113617, 1297403050, 81781910,
<a name="l00591"></a>00591     -1243373871, -2011476886, 532201772, 1367295589,
<a name="l00592"></a>00592     -368796322, 895287692, 1953757831, 1093597963,
<a name="l00593"></a>00593     492483431, -766340389, 1446242576, 1192455638,
<a name="l00594"></a>00594     1636604631, 209336225, 344873464, 1015671571,
<a name="l00595"></a>00595     669961897, -919226527, -437395172, -1321436601,
<a name="l00596"></a>00596     -547775278, 1933530610, -830924780, 935293895,
<a name="l00597"></a>00597     -840281097, -1436852227, 1863638845, -611944380,
<a name="l00598"></a>00598     -209597777, -1002522264, 875313188, 1080017571,
<a name="l00599"></a>00599     -1015933411, 621591778, 1233856572, -1790836979,
<a name="l00600"></a>00600     24197544, -1277294580, -459482956, -1047501738,
<a name="l00601"></a>00601     -2073986101, -1234119374, 1551124588, 1463996600
<a name="l00602"></a>00602 };
<a name="l00603"></a>00603 
<a name="l00604"></a>00604 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_T8[256] =
<a name="l00605"></a>00605 {
<a name="l00606"></a>00606     -190361519, 1097159550, 396673818, 660510266,
<a name="l00607"></a>00607     -1418998981, -1656360673, -94852180, -486304949,
<a name="l00608"></a>00608     821712160, 1986918061, -864644728, 38544885,
<a name="l00609"></a>00609     -438830001, 718002117, 893681702, 1654886325,
<a name="l00610"></a>00610     -1319482914, -1172609243, -368142267, -20913827,
<a name="l00611"></a>00611     796197571, 1290801793, 1184342925, -738605461,
<a name="l00612"></a>00612     -1889540349, -1835231979, 1836772287, 1381620373,
<a name="l00613"></a>00613     -1098699308, 1948373848, -529979063, -909622130,
<a name="l00614"></a>00614     -1031181707, -1904641804, 1480485785, -1183720153,
<a name="l00615"></a>00615     -514869570, -2001922064, 548169417, -835013507,
<a name="l00616"></a>00616     -548792221, 439452389, 1362321559, 1400849762,
<a name="l00617"></a>00617     1685577905, 1806599355, -2120213250, 137073913,
<a name="l00618"></a>00618     1214797936, 1174215055, -563312748, 2079897426,
<a name="l00619"></a>00619     1943217067, 1258480242, 529487843, 1437280870,
<a name="l00620"></a>00620     -349698126, -1245576401, -981755258, 923313619,
<a name="l00621"></a>00621     679998000, -1079659997, 57326082, 377642221,
<a name="l00622"></a>00622     -820237430, 2041877159, 133361907, 1776460110,
<a name="l00623"></a>00623     -621490843, 96392454, 878845905, -1493267772,
<a name="l00624"></a>00624     777231668, -212492126, -1964953083, -152341084,
<a name="l00625"></a>00625     -2081670901, 1626319424, 1906247262, 1846563261,
<a name="l00626"></a>00626     562755902, -586793578, 1040559837, -423803315,
<a name="l00627"></a>00627     1418573201, -1000536719, 114585348, 1343618912,
<a name="l00628"></a>00628     -1728371687, -1108764714, 1078185097, -643926169,
<a name="l00629"></a>00629     -398279248, -1987344377, 425408743, -923870343,
<a name="l00630"></a>00630     2081048481, 1108339068, -2078357000, 0,
<a name="l00631"></a>00631     -2138668279, 736970802, 292596766, 1517440620,
<a name="l00632"></a>00632     251657213, -2059905521, -1361764803, 758720310,
<a name="l00633"></a>00633     265905162, 1554391400, 1532285339, 908999204,
<a name="l00634"></a>00634     174567692, 1474760595, -292105548, -1684955621,
<a name="l00635"></a>00635     -1060810880, -601841055, 2001430874, 303699484,
<a name="l00636"></a>00636     -1816524062, -1607801408, 585122620, 454499602,
<a name="l00637"></a>00637     151849742, -1949848078, -1230456531, 514443284,
<a name="l00638"></a>00638     -249985705, 1963412655, -1713521682, 2137062819,
<a name="l00639"></a>00639     19308535, 1928707164, 1715193156, -75615141,
<a name="l00640"></a>00640     1126790795, 600235211, -302225226, -453942344,
<a name="l00641"></a>00641     836553431, 1669664834, -1759363053, -971956092,
<a name="l00642"></a>00642     1243905413, -1153566510, -114159186, 698445255,
<a name="l00643"></a>00643     -1641067747, -1305414692, -2041385971, -1042034569,
<a name="l00644"></a>00644     -1290376149, 1891211689, -1807156719, -379313593,
<a name="l00645"></a>00645     -57883480, -264299872, 2100090966, 865136418,
<a name="l00646"></a>00646     1229899655, 953270745, -895287668, -737462632,
<a name="l00647"></a>00647     -176042074, 2061379749, -1215420710, -1379949505,
<a name="l00648"></a>00648     983426092, 2022837584, 1607244650, 2118541908,
<a name="l00649"></a>00649     -1928084746, -658970480, 972512814, -1011878526,
<a name="l00650"></a>00650     1568718495, -795640727, -718427793, 621982671,
<a name="l00651"></a>00651     -1399243832, 410887952, -1671205144, 1002142683,
<a name="l00652"></a>00652     645401037, 1494807662, -1699282452, 1335535747,
<a name="l00653"></a>00653     -1787927066, -1671510, -1127282655, 367585007,
<a name="l00654"></a>00654     -409216582, 1865862730, -1626745622, -1333995991,
<a name="l00655"></a>00655     -1531793615, 1059270954, -1517014842, -1570324427,
<a name="l00656"></a>00656     1320957812, -2100648196, -1865371424, -1479011021,
<a name="l00657"></a>00657     77089521, -321194175, -850391425, -1846137065,
<a name="l00658"></a>00658     1305906550, -273658557, -1437772596, -1778065436,
<a name="l00659"></a>00659     -776608866, 1787304780, 740276417, 1699839814,
<a name="l00660"></a>00660     1592394909, -1942659839, -2022411270, 188821243,
<a name="l00661"></a>00661     1729977011, -606973294, 274084841, -699985043,
<a name="l00662"></a>00662     -681472870, -1593017801, -132870567, 322734571,
<a name="l00663"></a>00663     -1457000754, 1640576439, 484830689, 1202797690,
<a name="l00664"></a>00664     -757114468, -227328171, 349075736, -952647821,
<a name="l00665"></a>00665     -137500077, -39167137, 1030690015, 1155237496,
<a name="l00666"></a>00666     -1342996022, 1757691577, 607398968, -1556062270,
<a name="l00667"></a>00667     499347990, -500888388, 1011452712, 227885567,
<a name="l00668"></a>00668     -1476300487, 213114376, -1260086056, 1455525988,
<a name="l00669"></a>00669     -880516741, 850817237, 1817998408, -1202240816
<a name="l00670"></a>00670 };
<a name="l00671"></a>00671 
<a name="l00672"></a>00672 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_U1[256] =
<a name="l00673"></a>00673 {
<a name="l00674"></a>00674     0, 235474187, 470948374, 303765277,
<a name="l00675"></a>00675     941896748, 908933415, 607530554, 708780849,
<a name="l00676"></a>00676     1883793496, 2118214995, 1817866830, 1649639237,
<a name="l00677"></a>00677     1215061108, 1181045119, 1417561698, 1517767529,
<a name="l00678"></a>00678     -527380304, -291906117, -58537306, -225720403,
<a name="l00679"></a>00679     -659233636, -692196969, -995688822, -894438527,
<a name="l00680"></a>00680     -1864845080, -1630423581, -1932877058, -2101104651,
<a name="l00681"></a>00681     -1459843900, -1493859889, -1259432238, -1159226407,
<a name="l00682"></a>00682     -616842373, -718096784, -953573011, -920605594,
<a name="l00683"></a>00683     -484470953, -317291940, -15887039, -251357110,
<a name="l00684"></a>00684     -1418472669, -1518674392, -1218328267, -1184316354,
<a name="l00685"></a>00685     -1822955761, -1654724092, -1891238631, -2125664238,
<a name="l00686"></a>00686     1001089995, 899835584, 666464733, 699432150,
<a name="l00687"></a>00687     59727847, 226906860, 530400753, 294930682,
<a name="l00688"></a>00688     1273168787, 1172967064, 1475418501, 1509430414,
<a name="l00689"></a>00689     1942435775, 2110667444, 1876241833, 1641816226,
<a name="l00690"></a>00690     -1384747530, -1551933187, -1318815776, -1083344149,
<a name="l00691"></a>00691     -1789765158, -1688513327, -1992277044, -2025238841,
<a name="l00692"></a>00692     -583137874, -751368027, -1054072904, -819653965,
<a name="l00693"></a>00693     -451268222, -351060855, -116905068, -150919521,
<a name="l00694"></a>00694     1306967366, 1139781709, 1374988112, 1610459739,
<a name="l00695"></a>00695     1975683434, 2076935265, 1775276924, 1742315127,
<a name="l00696"></a>00696     1034867998, 866637845, 566021896, 800440835,
<a name="l00697"></a>00697     92987698, 193195065, 429456164, 395441711,
<a name="l00698"></a>00698     1984812685, 2017778566, 1784663195, 1683407248,
<a name="l00699"></a>00699     1315562145, 1080094634, 1383856311, 1551037884,
<a name="l00700"></a>00700     101039829, 135050206, 437757123, 337553864,
<a name="l00701"></a>00701     1042385657, 807962610, 573804783, 742039012,
<a name="l00702"></a>00702     -1763899843, -1730933962, -1966138325, -2067394272,
<a name="l00703"></a>00703     -1359400431, -1594867942, -1293211641, -1126030068,
<a name="l00704"></a>00704     -426414491, -392404114, -91786125, -191989384,
<a name="l00705"></a>00705     -558802359, -793225406, -1029488545, -861254316,
<a name="l00706"></a>00706     1106041591, 1340463100, 1576976609, 1408749034,
<a name="l00707"></a>00707     2043211483, 2009195472, 1708848333, 1809054150,
<a name="l00708"></a>00708     832877231, 1068351396, 766945465, 599762354,
<a name="l00709"></a>00709     159417987, 126454664, 361929877, 463180190,
<a name="l00710"></a>00710     -1585706425, -1351284916, -1116860335, -1285087910,
<a name="l00711"></a>00711     -1722270101, -1756286112, -2058738563, -1958532746,
<a name="l00712"></a>00712     -785096161, -549621996, -853116919, -1020300030,
<a name="l00713"></a>00713     -384805325, -417768648, -184398811, -83148498,
<a name="l00714"></a>00714     -1697160820, -1797362553, -2033878118, -1999866223,
<a name="l00715"></a>00715     -1561111136, -1392879445, -1092530250, -1326955843,
<a name="l00716"></a>00716     -358676012, -459930401, -158526526, -125559095,
<a name="l00717"></a>00717     -759480840, -592301837, -827774994, -1063245083,
<a name="l00718"></a>00718     2051518780, 1951317047, 1716890410, 1750902305,
<a name="l00719"></a>00719     1113818384, 1282050075, 1584504582, 1350078989,
<a name="l00720"></a>00720     168810852, 67556463, 371049330, 404016761,
<a name="l00721"></a>00721     841739592, 1008918595, 775550814, 540080725,
<a name="l00722"></a>00722     -325404927, -493635062, -259478249, -25059300,
<a name="l00723"></a>00723     -725712083, -625504730, -928212677, -962227152,
<a name="l00724"></a>00724     -1663901863, -1831087534, -2134850225, -1899378620,
<a name="l00725"></a>00725     -1527321739, -1426069890, -1192955549, -1225917336,
<a name="l00726"></a>00726     202008497, 33778362, 270040487, 504459436,
<a name="l00727"></a>00727     875451293, 975658646, 675039627, 641025152,
<a name="l00728"></a>00728     2084704233, 1917518562, 1615861247, 1851332852,
<a name="l00729"></a>00729     1147550661, 1248802510, 1484005843, 1451044056,
<a name="l00730"></a>00730     933301370, 967311729, 733156972, 632953703,
<a name="l00731"></a>00731     260388950, 25965917, 328671808, 496906059,
<a name="l00732"></a>00732     1206477858, 1239443753, 1543208500, 1441952575,
<a name="l00733"></a>00733     2144161806, 1908694277, 1675577880, 1842759443,
<a name="l00734"></a>00734     -684598070, -650587711, -886847780, -987051049,
<a name="l00735"></a>00735     -283776794, -518199827, -217582864, -49348613,
<a name="l00736"></a>00736     -1485196142, -1452230247, -1150570876, -1251826801,
<a name="l00737"></a>00737     -1621262146, -1856729675, -2091935064, -1924753501
<a name="l00738"></a>00738 };
<a name="l00739"></a>00739 
<a name="l00740"></a>00740 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_U2[256] =
<a name="l00741"></a>00741 {
<a name="l00742"></a>00742     0, 185469197, 370938394, 487725847,
<a name="l00743"></a>00743     741876788, 657861945, 975451694, 824852259,
<a name="l00744"></a>00744     1483753576, 1400783205, 1315723890, 1164071807,
<a name="l00745"></a>00745     1950903388, 2135319889, 1649704518, 1767536459,
<a name="l00746"></a>00746     -1327460144, -1141990947, -1493400886, -1376613433,
<a name="l00747"></a>00747     -1663519516, -1747534359, -1966823682, -2117423117,
<a name="l00748"></a>00748     -393160520, -476130891, -24327518, -175979601,
<a name="l00749"></a>00749     -995558260, -811141759, -759894378, -642062437,
<a name="l00750"></a>00750     2077965243, 1893020342, 1841768865, 1724457132,
<a name="l00751"></a>00751     1474502543, 1559041666, 1107234197, 1257309336,
<a name="l00752"></a>00752     598438867, 681933534, 901210569, 1052338372,
<a name="l00753"></a>00753     261314535, 77422314, 428819965, 310463728,
<a name="l00754"></a>00754     -885281941, -1070226842, -584599183, -701910916,
<a name="l00755"></a>00755     -419197089, -334657966, -249586363, -99511224,
<a name="l00756"></a>00756     -1823743229, -1740248562, -2057834215, -1906706412,
<a name="l00757"></a>00757     -1082931401, -1266823622, -1452288723, -1570644960,
<a name="l00758"></a>00758     -156404115, -39616672, -525245321, -339776134,
<a name="l00759"></a>00759     -627748263, -778347692, -863420349, -947435186,
<a name="l00760"></a>00760     -1361232379, -1512884472, -1195299809, -1278270190,
<a name="l00761"></a>00761     -2098914767, -1981082820, -1795618773, -1611202266,
<a name="l00762"></a>00762     1179510461, 1296297904, 1347548327, 1533017514,
<a name="l00763"></a>00763     1786102409, 1635502980, 2087309459, 2003294622,
<a name="l00764"></a>00764     507358933, 355706840, 136428751, 53458370,
<a name="l00765"></a>00765     839224033, 957055980, 605657339, 790073846,
<a name="l00766"></a>00766     -1921626666, -2038938405, -1687527476, -1872472383,
<a name="l00767"></a>00767     -1588696606, -1438621457, -1219331080, -1134791947,
<a name="l00768"></a>00768     -721025602, -569897805, -1021700188, -938205527,
<a name="l00769"></a>00769     -113368694, -231724921, -282971248, -466863459,
<a name="l00770"></a>00770     1033297158, 915985419, 730517276, 545572369,
<a name="l00771"></a>00771     296679730, 446754879, 129166120, 213705253,
<a name="l00772"></a>00772     1709610350, 1860738147, 1945798516, 2029293177,
<a name="l00773"></a>00773     1239331162, 1120974935, 1606591296, 1422699085,
<a name="l00774"></a>00774     -146674470, -61872681, -513933632, -363595827,
<a name="l00775"></a>00775     -612775698, -797457949, -848962828, -966011911,
<a name="l00776"></a>00776     -1355701070, -1539330625, -1188186456, -1306280027,
<a name="l00777"></a>00777     -2096529274, -2012771957, -1793748324, -1642357871,
<a name="l00778"></a>00778     1201765386, 1286567175, 1371368976, 1521706781,
<a name="l00779"></a>00779     1805211710, 1620529459, 2105887268, 1988838185,
<a name="l00780"></a>00780     533804130, 350174575, 164439672, 46346101,
<a name="l00781"></a>00781     870912086, 954669403, 636813900, 788204353,
<a name="l00782"></a>00782     -1936009375, -2020286868, -1702443653, -1853305738,
<a name="l00783"></a>00783     -1599933611, -1414727080, -1229004465, -1112479678,
<a name="l00784"></a>00784     -722821367, -538667516, -1024029421, -906460130,
<a name="l00785"></a>00785     -120407235, -203640272, -288446169, -440360918,
<a name="l00786"></a>00786     1014646705, 930369212, 711349675, 560487590,
<a name="l00787"></a>00787     272786309, 457992840, 106852767, 223377554,
<a name="l00788"></a>00788     1678381017, 1862534868, 1914052035, 2031621326,
<a name="l00789"></a>00789     1211247597, 1128014560, 1580087799, 1428173050,
<a name="l00790"></a>00790     32283319, 182621114, 401639597, 486441376,
<a name="l00791"></a>00791     768917123, 651868046, 1003007129, 818324884,
<a name="l00792"></a>00792     1503449823, 1385356242, 1333838021, 1150208456,
<a name="l00793"></a>00793     1973745387, 2125135846, 1673061617, 1756818940,
<a name="l00794"></a>00794     -1324610969, -1174273174, -1492117379, -1407315600,
<a name="l00795"></a>00795     -1657524653, -1774573730, -1960297399, -2144979644,
<a name="l00796"></a>00796     -377732593, -495826174, -10465259, -194094824,
<a name="l00797"></a>00797     -985373125, -833982666, -749177823, -665420500,
<a name="l00798"></a>00798     2050466060, 1899603969, 1814803222, 1730525723,
<a name="l00799"></a>00799     1443857720, 1560382517, 1075025698, 1260232239,
<a name="l00800"></a>00800     575138148, 692707433, 878443390, 1062597235,
<a name="l00801"></a>00801     243256656, 91341917, 409198410, 325965383,
<a name="l00802"></a>00802     -891866660, -1042728751, -590666810, -674944309,
<a name="l00803"></a>00803     -420538904, -304014107, -252508174, -67301633,
<a name="l00804"></a>00804     -1834518092, -1716948807, -2068091986, -1883938141,
<a name="l00805"></a>00805     -1096852096, -1248766835, -1467789414, -1551022441,
<a name="l00806"></a>00806 };
<a name="l00807"></a>00807 
<a name="l00808"></a>00808 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_U3[256] =
<a name="l00809"></a>00809 {
<a name="l00810"></a>00810     0, 218828297, 437656594, 387781147,
<a name="l00811"></a>00811     875313188, 958871085, 775562294, 590424639,
<a name="l00812"></a>00812     1750626376, 1699970625, 1917742170, 2135253587,
<a name="l00813"></a>00813     1551124588, 1367295589, 1180849278, 1265195639,
<a name="l00814"></a>00814     -793714544, -574886247, -895026046, -944901493,
<a name="l00815"></a>00815     -459482956, -375925059, -24460122, -209597777,
<a name="l00816"></a>00816     -1192718120, -1243373871, -1560376118, -1342864701,
<a name="l00817"></a>00817     -1933268740, -2117097739, -1764576018, -1680229657,
<a name="l00818"></a>00818     -1149510853, -1234119374, -1586641111, -1402549984,
<a name="l00819"></a>00819     -1890065633, -2107839210, -1790836979, -1739919100,
<a name="l00820"></a>00820     -752637069, -567761542, -919226527, -1002522264,
<a name="l00821"></a>00821     -418409641, -368796322, -48656571, -267222708,
<a name="l00822"></a>00822     1808481195, 1723872674, 1910319033, 2094410160,
<a name="l00823"></a>00823     1608975247, 1391201670, 1173430173, 1224348052,
<a name="l00824"></a>00824     59984867, 244860394, 428169201, 344873464,
<a name="l00825"></a>00825     935293895, 984907214, 766078933, 547512796,
<a name="l00826"></a>00826     1844882806, 1627235199, 2011214180, 2062270317,
<a name="l00827"></a>00827     1507497298, 1423022939, 1137477952, 1321699145,
<a name="l00828"></a>00828     95345982, 145085239, 532201772, 313773861,
<a name="l00829"></a>00829     830661914, 1015671571, 731183368, 648017665,
<a name="l00830"></a>00830     -1119466010, -1337113617, -1487908364, -1436852227,
<a name="l00831"></a>00831     -1989511742, -2073986101, -1820562992, -1636341799,
<a name="l00832"></a>00832     -719438418, -669699161, -821550660, -1039978571,
<a name="l00833"></a>00833     -516815478, -331805821, -81520232, -164685935,
<a name="l00834"></a>00834     -695372211, -611944380, -862229921, -1047501738,
<a name="l00835"></a>00835     -492745111, -274055072, -122203525, -172204942,
<a name="l00836"></a>00836     -1093335547, -1277294580, -1530717673, -1446505442,
<a name="l00837"></a>00837     -1963377119, -2014171096, -1863376333, -1645990854,
<a name="l00838"></a>00838     104699613, 188127444, 472615631, 287343814,
<a name="l00839"></a>00839     840019705, 1058709744, 671593195, 621591778,
<a name="l00840"></a>00840     1852171925, 1668212892, 1953757831, 2037970062,
<a name="l00841"></a>00841     1514790577, 1463996600, 1080017571, 1297403050,
<a name="l00842"></a>00842     -621329940, -671330331, -1058972162, -840281097,
<a name="l00843"></a>00843     -287606328, -472877119, -187865638, -104436781,
<a name="l00844"></a>00844     -1297141340, -1079754835, -1464259146, -1515052097,
<a name="l00845"></a>00845     -2038232704, -1954019447, -1667951214, -1851909221,
<a name="l00846"></a>00846     172466556, 122466165, 273792366, 492483431,
<a name="l00847"></a>00847     1047239000, 861968209, 612205898, 695634755,
<a name="l00848"></a>00848     1646252340, 1863638845, 2013908262, 1963115311,
<a name="l00849"></a>00849     1446242576, 1530455833, 1277555970, 1093597963,
<a name="l00850"></a>00850     1636604631, 1820824798, 2073724613, 1989249228,
<a name="l00851"></a>00851     1436590835, 1487645946, 1337376481, 1119727848,
<a name="l00852"></a>00852     164948639, 81781910, 331544205, 516552836,
<a name="l00853"></a>00853     1039717051, 821288114, 669961897, 719700128,
<a name="l00854"></a>00854     -1321436601, -1137216434, -1423284651, -1507760036,
<a name="l00855"></a>00855     -2062531997, -2011476886, -1626972559, -1844621192,
<a name="l00856"></a>00856     -647755249, -730921978, -1015933411, -830924780,
<a name="l00857"></a>00857     -314035669, -532464606, -144822727, -95084496,
<a name="l00858"></a>00858     -1224610662, -1173691757, -1390940024, -1608712575,
<a name="l00859"></a>00859     -2094148418, -1910056265, -1724135252, -1808742747,
<a name="l00860"></a>00860     -547775278, -766340389, -984645440, -935031095,
<a name="l00861"></a>00861     -344611594, -427906305, -245122844, -60246291,
<a name="l00862"></a>00862     1739656202, 1790575107, 2108100632, 1890328081,
<a name="l00863"></a>00863     1402811438, 1586903591, 1233856572, 1149249077,
<a name="l00864"></a>00864     266959938, 48394827, 369057872, 418672217,
<a name="l00865"></a>00865     1002783846, 919489135, 567498868, 752375421,
<a name="l00866"></a>00866     209336225, 24197544, 376187827, 459744698,
<a name="l00867"></a>00867     945164165, 895287692, 574624663, 793451934,
<a name="l00868"></a>00868     1679968233, 1764313568, 2117360635, 1933530610,
<a name="l00869"></a>00869     1343127501, 1560637892, 1243112415, 1192455638,
<a name="l00870"></a>00870     -590686415, -775825096, -958608605, -875051734,
<a name="l00871"></a>00871     -387518699, -437395172, -219090169, -262898,
<a name="l00872"></a>00872     -1265457287, -1181111952, -1367032981, -1550863006,
<a name="l00873"></a>00873     -2134991011, -1917480620, -1700232369, -1750889146
<a name="l00874"></a>00874 };
<a name="l00875"></a>00875 
<a name="l00876"></a>00876 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_U4[256] =
<a name="l00877"></a>00877 {
<a name="l00878"></a>00878     0, 151849742, 303699484, 454499602,
<a name="l00879"></a>00879     607398968, 758720310, 908999204, 1059270954,
<a name="l00880"></a>00880     1214797936, 1097159550, 1517440620, 1400849762,
<a name="l00881"></a>00881     1817998408, 1699839814, 2118541908, 2001430874,
<a name="l00882"></a>00882     -1865371424, -1713521682, -2100648196, -1949848078,
<a name="l00883"></a>00883     -1260086056, -1108764714, -1493267772, -1342996022,
<a name="l00884"></a>00884     -658970480, -776608866, -895287668, -1011878526,
<a name="l00885"></a>00885     -57883480, -176042074, -292105548, -409216582,
<a name="l00886"></a>00886     1002142683, 850817237, 698445255, 548169417,
<a name="l00887"></a>00887     529487843, 377642221, 227885567, 77089521,
<a name="l00888"></a>00888     1943217067, 2061379749, 1640576439, 1757691577,
<a name="l00889"></a>00889     1474760595, 1592394909, 1174215055, 1290801793,
<a name="l00890"></a>00890     -1418998981, -1570324427, -1183720153, -1333995991,
<a name="l00891"></a>00891     -1889540349, -2041385971, -1656360673, -1807156719,
<a name="l00892"></a>00892     -486304949, -368142267, -249985705, -132870567,
<a name="l00893"></a>00893     -952647821, -835013507, -718427793, -601841055,
<a name="l00894"></a>00894     1986918061, 2137062819, 1685577905, 1836772287,
<a name="l00895"></a>00895     1381620373, 1532285339, 1078185097, 1229899655,
<a name="l00896"></a>00896     1040559837, 923313619, 740276417, 621982671,
<a name="l00897"></a>00897     439452389, 322734571, 137073913, 19308535,
<a name="l00898"></a>00898     -423803315, -273658557, -190361519, -39167137,
<a name="l00899"></a>00899     -1031181707, -880516741, -795640727, -643926169,
<a name="l00900"></a>00900     -1361764803, -1479011021, -1127282655, -1245576401,
<a name="l00901"></a>00901     -1964953083, -2081670901, -1728371687, -1846137065,
<a name="l00902"></a>00902     1305906550, 1155237496, 1607244650, 1455525988,
<a name="l00903"></a>00903     1776460110, 1626319424, 2079897426, 1928707164,
<a name="l00904"></a>00904     96392454, 213114376, 396673818, 514443284,
<a name="l00905"></a>00905     562755902, 679998000, 865136418, 983426092,
<a name="l00906"></a>00906     -586793578, -737462632, -820237430, -971956092,
<a name="l00907"></a>00907     -114159186, -264299872, -349698126, -500888388,
<a name="l00908"></a>00908     -1787927066, -1671205144, -2022411270, -1904641804,
<a name="l00909"></a>00909     -1319482914, -1202240816, -1556062270, -1437772596,
<a name="l00910"></a>00910     -321194175, -438830001, -20913827, -137500077,
<a name="l00911"></a>00911     -923870343, -1042034569, -621490843, -738605461,
<a name="l00912"></a>00912     -1531793615, -1379949505, -1230456531, -1079659997,
<a name="l00913"></a>00913     -2138668279, -1987344377, -1835231979, -1684955621,
<a name="l00914"></a>00914     2081048481, 1963412655, 1846563261, 1729977011,
<a name="l00915"></a>00915     1480485785, 1362321559, 1243905413, 1126790795,
<a name="l00916"></a>00916     878845905, 1030690015, 645401037, 796197571,
<a name="l00917"></a>00917     274084841, 425408743, 38544885, 188821243,
<a name="l00918"></a>00918     -681472870, -563312748, -981755258, -864644728,
<a name="l00919"></a>00919     -212492126, -94852180, -514869570, -398279248,
<a name="l00920"></a>00920     -1626745622, -1778065436, -1928084746, -2078357000,
<a name="l00921"></a>00921     -1153566510, -1305414692, -1457000754, -1607801408,
<a name="l00922"></a>00922     1202797690, 1320957812, 1437280870, 1554391400,
<a name="l00923"></a>00923     1669664834, 1787304780, 1906247262, 2022837584,
<a name="l00924"></a>00924     265905162, 114585348, 499347990, 349075736,
<a name="l00925"></a>00925     736970802, 585122620, 972512814, 821712160,
<a name="l00926"></a>00926     -1699282452, -1816524062, -2001922064, -2120213250,
<a name="l00927"></a>00927     -1098699308, -1215420710, -1399243832, -1517014842,
<a name="l00928"></a>00928     -757114468, -606973294, -1060810880, -909622130,
<a name="l00929"></a>00929     -152341084, -1671510, -453942344, -302225226,
<a name="l00930"></a>00930     174567692, 57326082, 410887952, 292596766,
<a name="l00931"></a>00931     777231668, 660510266, 1011452712, 893681702,
<a name="l00932"></a>00932     1108339068, 1258480242, 1343618912, 1494807662,
<a name="l00933"></a>00933     1715193156, 1865862730, 1948373848, 2100090966,
<a name="l00934"></a>00934     -1593017801, -1476300487, -1290376149, -1172609243,
<a name="l00935"></a>00935     -2059905521, -1942659839, -1759363053, -1641067747,
<a name="l00936"></a>00936     -379313593, -529979063, -75615141, -227328171,
<a name="l00937"></a>00937     -850391425, -1000536719, -548792221, -699985043,
<a name="l00938"></a>00938     836553431, 953270745, 600235211, 718002117,
<a name="l00939"></a>00939     367585007, 484830689, 133361907, 251657213,
<a name="l00940"></a>00940     2041877159, 1891211689, 1806599355, 1654886325,
<a name="l00941"></a>00941     1568718495, 1418573201, 1335535747, 1184342925
<a name="l00942"></a>00942 };
<a name="l00943"></a>00943 
<a name="l00944"></a>00944 <span class="keyword">const</span> <span class="keywordtype">char</span> Encoder::sm_rcon[30] =
<a name="l00945"></a>00945 {
<a name="l00946"></a>00946     1, 2, 4, 8, 16, 32,
<a name="l00947"></a>00947     64, -128, 27, 54, 108, -40,
<a name="l00948"></a>00948     -85, 77, -102, 47, 94, -68,
<a name="l00949"></a>00949     99, -58, -105, 53, 106, -44,
<a name="l00950"></a>00950     -77, 125, -6, -17, -59, -111
<a name="l00951"></a>00951 };
<a name="l00952"></a>00952 
<a name="l00953"></a>00953 <span class="keyword">const</span> <span class="keywordtype">int</span> Encoder::sm_shifts[3][4][2] =
<a name="l00954"></a>00954 {
<a name="l00955"></a>00955     { {0, 0}, {1, 3}, {2, 2}, {3, 1} },
<a name="l00956"></a>00956     { {0, 0}, {1, 5}, {2, 4}, {3, 3} },
<a name="l00957"></a>00957     { {0, 0}, {1, 7}, {3, 5}, {4, 4} }
<a name="l00958"></a>00958 };
<a name="l00959"></a>00959 
<a name="l00960"></a>00960 
<a name="l00961"></a>00961 
<a name="l00962"></a>00962 <span class="keywordtype">char</span> <span class="keyword">const</span>* <a class="code" href="../../d3/d1d/class_encoder.html#adf6d11528bbf67e3b07303ed00a065fb">Encoder::sm_chain0</a> = <span class="stringliteral">&quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&quot;</span>;
<a name="l00963"></a>00963 
<a name="l00964"></a>00964 
<a name="l00965"></a><a class="code" href="../../d3/d1d/class_encoder.html#ab5d9324930644abeb150da7a7747ffe3">00965</a> <a class="code" href="../../d3/d1d/class_encoder.html#ab5d9324930644abeb150da7a7747ffe3">Encoder::Encoder</a>() : m_bKeyInit(false)
<a name="l00966"></a>00966 {
<a name="l00967"></a>00967 }
<a name="l00968"></a>00968 
<a name="l00969"></a>00969 
<a name="l00970"></a><a class="code" href="../../d3/d1d/class_encoder.html#a87cc8067c98c0ab2134dee3822e3b250">00970</a> <a class="code" href="../../d3/d1d/class_encoder.html#a87cc8067c98c0ab2134dee3822e3b250">Encoder::~Encoder</a>()
<a name="l00971"></a>00971 {
<a name="l00972"></a>00972 }
<a name="l00973"></a>00973 
<a name="l00974"></a><a class="code" href="../../d3/d1d/class_encoder.html#a0855e586e76a7660eb2cdb90d684928a">00974</a> <span class="keywordtype">void</span> <a class="code" href="../../d3/d1d/class_encoder.html#a0855e586e76a7660eb2cdb90d684928a">Encoder::MakeKey</a>(<span class="keywordtype">char</span> <span class="keyword">const</span>* key, <span class="keywordtype">char</span> <span class="keyword">const</span>* chain, <span class="keywordtype">int</span> keylength, <span class="keywordtype">int</span> blockSize)
<a name="l00975"></a>00975 {
<a name="l00976"></a>00976     <span class="keywordflow">if</span>(NULL == key)
<a name="l00977"></a>00977     {
<a name="l00978"></a>00978         <span class="keywordflow">throw</span> exception();
<a name="l00979"></a>00979     }
<a name="l00980"></a>00980 
<a name="l00981"></a>00981     <span class="keywordflow">if</span>(!(16 == keylength || 24 == keylength || 32 == keylength))
<a name="l00982"></a>00982     {
<a name="l00983"></a>00983         <span class="keywordflow">throw</span> exception();
<a name="l00984"></a>00984     }
<a name="l00985"></a>00985 
<a name="l00986"></a>00986     <span class="keywordflow">if</span>(!(16 == blockSize || 24 == blockSize || 32 == blockSize))
<a name="l00987"></a>00987     {
<a name="l00988"></a>00988         <span class="keywordflow">throw</span> exception();
<a name="l00989"></a>00989     }
<a name="l00990"></a>00990 
<a name="l00991"></a>00991     m_keylength = keylength;
<a name="l00992"></a>00992     m_blockSize = blockSize;
<a name="l00993"></a>00993     memcpy(m_chain0, chain, m_blockSize);
<a name="l00994"></a>00994     memcpy(m_chain, chain, m_blockSize);
<a name="l00995"></a>00995 
<a name="l00996"></a>00996     <span class="keywordflow">switch</span>(m_keylength)
<a name="l00997"></a>00997     {
<a name="l00998"></a>00998         <span class="keywordflow">case</span> 16:
<a name="l00999"></a>00999             m_iROUNDS = (m_blockSize == 16) ? 10 : (m_blockSize == 24 ? 12 : 14);
<a name="l01000"></a>01000             <span class="keywordflow">break</span>;
<a name="l01001"></a>01001         <span class="keywordflow">case</span> 24:
<a name="l01002"></a>01002             m_iROUNDS = (m_blockSize != 32) ? 12 : 14;
<a name="l01003"></a>01003             <span class="keywordflow">break</span>;
<a name="l01004"></a>01004         <span class="keywordflow">default</span>: <span class="comment">// 32 bytes = 256 bits</span>
<a name="l01005"></a>01005             m_iROUNDS = 14;
<a name="l01006"></a>01006     }
<a name="l01007"></a>01007 
<a name="l01008"></a>01008     <span class="keywordtype">int</span> BC = m_blockSize / 4;
<a name="l01009"></a>01009     <span class="keywordtype">int</span> i, j;
<a name="l01010"></a>01010 
<a name="l01011"></a>01011     <span class="keywordflow">for</span>(i = 0; i &lt;= m_iROUNDS; i++)
<a name="l01012"></a>01012     {
<a name="l01013"></a>01013         <span class="keywordflow">for</span>(j = 0; j &lt; BC; j++)
<a name="l01014"></a>01014         {
<a name="l01015"></a>01015             m_Ke[i][j] = 0;
<a name="l01016"></a>01016         }
<a name="l01017"></a>01017     }
<a name="l01018"></a>01018 
<a name="l01019"></a>01019     <span class="keywordflow">for</span>(i = 0; i &lt;= m_iROUNDS; i++)
<a name="l01020"></a>01020     {
<a name="l01021"></a>01021         <span class="keywordflow">for</span>(j = 0; j &lt; BC; j++)
<a name="l01022"></a>01022         {
<a name="l01023"></a>01023             m_Kd[i][j] = 0;
<a name="l01024"></a>01024         }
<a name="l01025"></a>01025     }
<a name="l01026"></a>01026 
<a name="l01027"></a>01027     <span class="keywordtype">int</span> ROUND_KEY_COUNT = (m_iROUNDS + 1) * BC;
<a name="l01028"></a>01028     <span class="keywordtype">int</span> KC = m_keylength / 4;
<a name="l01029"></a>01029     <span class="keywordtype">int</span>* pi = tk;
<a name="l01030"></a>01030     <span class="keywordtype">char</span> <span class="keyword">const</span>* pc = key;
<a name="l01031"></a>01031 
<a name="l01032"></a>01032     <span class="keywordflow">for</span>(i = 0; i &lt; KC; i++)
<a name="l01033"></a>01033     {
<a name="l01034"></a>01034         *pi = (<span class="keywordtype">unsigned</span> char) * (pc++) &lt;&lt; 24;
<a name="l01035"></a>01035         *pi |= (<span class="keywordtype">unsigned</span> char) * (pc++) &lt;&lt; 16;
<a name="l01036"></a>01036         *pi |= (<span class="keywordtype">unsigned</span> char) * (pc++) &lt;&lt; 8;
<a name="l01037"></a>01037         *(pi++) |= (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) * (pc++);
<a name="l01038"></a>01038     }
<a name="l01039"></a>01039 
<a name="l01040"></a>01040     <span class="keywordtype">int</span> t = 0;
<a name="l01041"></a>01041 
<a name="l01042"></a>01042     <span class="keywordflow">for</span>(j = 0; (j &lt; KC) &amp;&amp; (t &lt; ROUND_KEY_COUNT); j++, t++)
<a name="l01043"></a>01043     {
<a name="l01044"></a>01044         m_Ke[t/BC][t%BC] = tk[j];
<a name="l01045"></a>01045         m_Kd[m_iROUNDS - (t/BC)][t%BC] = tk[j];
<a name="l01046"></a>01046     }
<a name="l01047"></a>01047 
<a name="l01048"></a>01048     <span class="keywordtype">int</span> tt, rconpointer = 0;
<a name="l01049"></a>01049 
<a name="l01050"></a>01050     <span class="keywordflow">while</span>(t &lt; ROUND_KEY_COUNT)
<a name="l01051"></a>01051     {
<a name="l01052"></a>01052         tt = tk[KC-1];
<a name="l01053"></a>01053         tk[0] ^= (sm_S[(tt &gt;&gt; 16) &amp; 0xFF] &amp; 0xFF) &lt;&lt; 24 ^
<a name="l01054"></a>01054                  (sm_S[(tt &gt;&gt;  8) &amp; 0xFF] &amp; 0xFF) &lt;&lt; 16 ^
<a name="l01055"></a>01055                  (sm_S[ tt &amp; 0xFF] &amp; 0xFF) &lt;&lt;  8 ^
<a name="l01056"></a>01056                  (sm_S[(tt &gt;&gt; 24) &amp; 0xFF] &amp; 0xFF) ^
<a name="l01057"></a>01057                  (sm_rcon[rconpointer++]  &amp; 0xFF) &lt;&lt; 24;
<a name="l01058"></a>01058 
<a name="l01059"></a>01059         <span class="keywordflow">if</span>(KC != 8)
<a name="l01060"></a>01060             <span class="keywordflow">for</span>(i = 1, j = 0; i &lt; KC;)
<a name="l01061"></a>01061             {
<a name="l01062"></a>01062                 tk[i++] ^= tk[j++];
<a name="l01063"></a>01063             }
<a name="l01064"></a>01064         <span class="keywordflow">else</span>
<a name="l01065"></a>01065         {
<a name="l01066"></a>01066             <span class="keywordflow">for</span>(i = 1, j = 0; i &lt; KC / 2;)
<a name="l01067"></a>01067             {
<a name="l01068"></a>01068                 tk[i++] ^= tk[j++];
<a name="l01069"></a>01069             }
<a name="l01070"></a>01070 
<a name="l01071"></a>01071             tt = tk[KC/2-1];
<a name="l01072"></a>01072             tk[KC/2] ^= (sm_S[ tt &amp; 0xFF] &amp; 0xFF) ^
<a name="l01073"></a>01073                         (sm_S[(tt &gt;&gt;  8) &amp; 0xFF] &amp; 0xFF) &lt;&lt;  8 ^
<a name="l01074"></a>01074                         (sm_S[(tt &gt;&gt; 16) &amp; 0xFF] &amp; 0xFF) &lt;&lt; 16 ^
<a name="l01075"></a>01075                         (sm_S[(tt &gt;&gt; 24) &amp; 0xFF] &amp; 0xFF) &lt;&lt; 24;
<a name="l01076"></a>01076 
<a name="l01077"></a>01077             <span class="keywordflow">for</span>(j = KC / 2, i = j + 1; i &lt; KC;)
<a name="l01078"></a>01078             {
<a name="l01079"></a>01079                 tk[i++] ^= tk[j++];
<a name="l01080"></a>01080             }
<a name="l01081"></a>01081         }
<a name="l01082"></a>01082 
<a name="l01083"></a>01083         <span class="keywordflow">for</span>(j = 0; (j &lt; KC) &amp;&amp; (t &lt; ROUND_KEY_COUNT); j++, t++)
<a name="l01084"></a>01084         {
<a name="l01085"></a>01085             m_Ke[t/BC][t%BC] = tk[j];
<a name="l01086"></a>01086             m_Kd[m_iROUNDS - (t/BC)][t%BC] = tk[j];
<a name="l01087"></a>01087         }
<a name="l01088"></a>01088     }
<a name="l01089"></a>01089 
<a name="l01090"></a>01090     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r = 1; r &lt; m_iROUNDS; r++)
<a name="l01091"></a>01091         <span class="keywordflow">for</span>(j = 0; j &lt; BC; j++)
<a name="l01092"></a>01092         {
<a name="l01093"></a>01093             tt = m_Kd[r][j];
<a name="l01094"></a>01094             m_Kd[r][j] = sm_U1[(tt &gt;&gt; 24) &amp; 0xFF] ^
<a name="l01095"></a>01095                          sm_U2[(tt &gt;&gt; 16) &amp; 0xFF] ^
<a name="l01096"></a>01096                          sm_U3[(tt &gt;&gt;  8) &amp; 0xFF] ^
<a name="l01097"></a>01097                          sm_U4[tt &amp; 0xFF];
<a name="l01098"></a>01098         }
<a name="l01099"></a>01099 
<a name="l01100"></a>01100     m_bKeyInit = <span class="keyword">true</span>;
<a name="l01101"></a>01101 }
<a name="l01102"></a>01102 
<a name="l01103"></a>01103 <span class="keywordtype">void</span> Encoder::DefEncryptBlock(<span class="keywordtype">char</span> <span class="keyword">const</span>* in, <span class="keywordtype">char</span>* result)
<a name="l01104"></a>01104 {
<a name="l01105"></a>01105     <span class="keywordflow">if</span>(<span class="keyword">false</span> == m_bKeyInit)
<a name="l01106"></a>01106     {
<a name="l01107"></a>01107         <span class="keywordflow">throw</span> exception();
<a name="l01108"></a>01108     }
<a name="l01109"></a>01109 
<a name="l01110"></a>01110     <span class="keywordtype">int</span>* Ker = m_Ke[0];
<a name="l01111"></a>01111     <span class="keywordtype">int</span> t0 = ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 24);
<a name="l01112"></a>01112     t0 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 16);
<a name="l01113"></a>01113     t0 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 8);
<a name="l01114"></a>01114     (t0 |= (<span class="keywordtype">unsigned</span> char) * (in++)) ^= Ker[0];
<a name="l01115"></a>01115     <span class="keywordtype">int</span> t1 = ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 24);
<a name="l01116"></a>01116     t1 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 16);
<a name="l01117"></a>01117     t1 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 8);
<a name="l01118"></a>01118     (t1 |= (<span class="keywordtype">unsigned</span> char) * (in++)) ^= Ker[1];
<a name="l01119"></a>01119     <span class="keywordtype">int</span> t2 = ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 24);
<a name="l01120"></a>01120     t2 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 16);
<a name="l01121"></a>01121     t2 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 8);
<a name="l01122"></a>01122     (t2 |= (<span class="keywordtype">unsigned</span> char) * (in++)) ^= Ker[2];
<a name="l01123"></a>01123     <span class="keywordtype">int</span> t3 = ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 24);
<a name="l01124"></a>01124     t3 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 16);
<a name="l01125"></a>01125     t3 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 8);
<a name="l01126"></a>01126     (t3 |= (<span class="keywordtype">unsigned</span> char) * (in++)) ^= Ker[3];
<a name="l01127"></a>01127     <span class="keywordtype">int</span> a0, a1, a2, a3;
<a name="l01128"></a>01128 
<a name="l01129"></a>01129     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r = 1; r &lt; m_iROUNDS; r++)
<a name="l01130"></a>01130     {
<a name="l01131"></a>01131         Ker = m_Ke[r];
<a name="l01132"></a>01132         a0 = (sm_T1[(t0 &gt;&gt; 24) &amp; 0xFF] ^
<a name="l01133"></a>01133               sm_T2[(t1 &gt;&gt; 16) &amp; 0xFF] ^
<a name="l01134"></a>01134               sm_T3[(t2 &gt;&gt;  8) &amp; 0xFF] ^
<a name="l01135"></a>01135               sm_T4[t3 &amp; 0xFF]) ^ Ker[0];
<a name="l01136"></a>01136         a1 = (sm_T1[(t1 &gt;&gt; 24) &amp; 0xFF] ^
<a name="l01137"></a>01137               sm_T2[(t2 &gt;&gt; 16) &amp; 0xFF] ^
<a name="l01138"></a>01138               sm_T3[(t3 &gt;&gt;  8) &amp; 0xFF] ^
<a name="l01139"></a>01139               sm_T4[t0 &amp; 0xFF]) ^ Ker[1];
<a name="l01140"></a>01140         a2 = (sm_T1[(t2 &gt;&gt; 24) &amp; 0xFF] ^
<a name="l01141"></a>01141               sm_T2[(t3 &gt;&gt; 16) &amp; 0xFF] ^
<a name="l01142"></a>01142               sm_T3[(t0 &gt;&gt;  8) &amp; 0xFF] ^
<a name="l01143"></a>01143               sm_T4[t1 &amp; 0xFF]) ^ Ker[2];
<a name="l01144"></a>01144         a3 = (sm_T1[(t3 &gt;&gt; 24) &amp; 0xFF] ^
<a name="l01145"></a>01145               sm_T2[(t0 &gt;&gt; 16) &amp; 0xFF] ^
<a name="l01146"></a>01146               sm_T3[(t1 &gt;&gt;  8) &amp; 0xFF] ^
<a name="l01147"></a>01147               sm_T4[t2 &amp; 0xFF]) ^ Ker[3];
<a name="l01148"></a>01148         t0 = a0;
<a name="l01149"></a>01149         t1 = a1;
<a name="l01150"></a>01150         t2 = a2;
<a name="l01151"></a>01151         t3 = a3;
<a name="l01152"></a>01152     }
<a name="l01153"></a>01153 
<a name="l01154"></a>01154     Ker = m_Ke[m_iROUNDS];
<a name="l01155"></a>01155     <span class="keywordtype">int</span> tt = Ker[0];
<a name="l01156"></a>01156     result[0] = sm_S[(t0 &gt;&gt; 24) &amp; 0xFF] ^(tt &gt;&gt; 24);
<a name="l01157"></a>01157     result[1] = sm_S[(t1 &gt;&gt; 16) &amp; 0xFF] ^(tt &gt;&gt; 16);
<a name="l01158"></a>01158     result[2] = sm_S[(t2 &gt;&gt;  8) &amp; 0xFF] ^(tt &gt;&gt;  8);
<a name="l01159"></a>01159     result[3] = sm_S[t3 &amp; 0xFF] ^ tt;
<a name="l01160"></a>01160     tt = Ker[1];
<a name="l01161"></a>01161     result[4] = sm_S[(t1 &gt;&gt; 24) &amp; 0xFF] ^(tt &gt;&gt; 24);
<a name="l01162"></a>01162     result[5] = sm_S[(t2 &gt;&gt; 16) &amp; 0xFF] ^(tt &gt;&gt; 16);
<a name="l01163"></a>01163     result[6] = sm_S[(t3 &gt;&gt;  8) &amp; 0xFF] ^(tt &gt;&gt;  8);
<a name="l01164"></a>01164     result[7] = sm_S[t0 &amp; 0xFF] ^ tt;
<a name="l01165"></a>01165     tt = Ker[2];
<a name="l01166"></a>01166     result[8] = sm_S[(t2 &gt;&gt; 24) &amp; 0xFF] ^(tt &gt;&gt; 24);
<a name="l01167"></a>01167     result[9] = sm_S[(t3 &gt;&gt; 16) &amp; 0xFF] ^(tt &gt;&gt; 16);
<a name="l01168"></a>01168     result[10] = sm_S[(t0 &gt;&gt;  8) &amp; 0xFF] ^(tt &gt;&gt;  8);
<a name="l01169"></a>01169     result[11] = sm_S[t1 &amp; 0xFF] ^ tt;
<a name="l01170"></a>01170     tt = Ker[3];
<a name="l01171"></a>01171     result[12] = sm_S[(t3 &gt;&gt; 24) &amp; 0xFF] ^(tt &gt;&gt; 24);
<a name="l01172"></a>01172     result[13] = sm_S[(t0 &gt;&gt; 16) &amp; 0xFF] ^(tt &gt;&gt; 16);
<a name="l01173"></a>01173     result[14] = sm_S[(t1 &gt;&gt;  8) &amp; 0xFF] ^(tt &gt;&gt;  8);
<a name="l01174"></a>01174     result[15] = sm_S[t2 &amp; 0xFF] ^ tt;
<a name="l01175"></a>01175 }
<a name="l01176"></a>01176 
<a name="l01177"></a>01177 <span class="keywordtype">void</span> Encoder::DefDecryptBlock(<span class="keywordtype">char</span> <span class="keyword">const</span>* in, <span class="keywordtype">char</span>* result)
<a name="l01178"></a>01178 {
<a name="l01179"></a>01179     <span class="keywordflow">if</span>(<span class="keyword">false</span> == m_bKeyInit)
<a name="l01180"></a>01180     {
<a name="l01181"></a>01181         <span class="keywordflow">throw</span> exception();
<a name="l01182"></a>01182     }
<a name="l01183"></a>01183 
<a name="l01184"></a>01184     <span class="keywordtype">int</span>* Kdr = m_Kd[0];
<a name="l01185"></a>01185     <span class="keywordtype">int</span> t0 = ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 24);
<a name="l01186"></a>01186     t0 = t0 | ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 16);
<a name="l01187"></a>01187     t0 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 8);
<a name="l01188"></a>01188     (t0 |= (<span class="keywordtype">unsigned</span> char) * (in++)) ^= Kdr[0];
<a name="l01189"></a>01189     <span class="keywordtype">int</span> t1 = ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 24);
<a name="l01190"></a>01190     t1 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 16);
<a name="l01191"></a>01191     t1 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 8);
<a name="l01192"></a>01192     (t1 |= (<span class="keywordtype">unsigned</span> char) * (in++)) ^= Kdr[1];
<a name="l01193"></a>01193     <span class="keywordtype">int</span> t2 = ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 24);
<a name="l01194"></a>01194     t2 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 16);
<a name="l01195"></a>01195     t2 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 8);
<a name="l01196"></a>01196     (t2 |= (<span class="keywordtype">unsigned</span> char) * (in++)) ^= Kdr[2];
<a name="l01197"></a>01197     <span class="keywordtype">int</span> t3 = ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 24);
<a name="l01198"></a>01198     t3 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 16);
<a name="l01199"></a>01199     t3 |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 8);
<a name="l01200"></a>01200     (t3 |= (<span class="keywordtype">unsigned</span> char) * (in++)) ^= Kdr[3];
<a name="l01201"></a>01201     <span class="keywordtype">int</span> a0, a1, a2, a3;
<a name="l01202"></a>01202 
<a name="l01203"></a>01203     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r = 1; r &lt; m_iROUNDS; r++)
<a name="l01204"></a>01204     {
<a name="l01205"></a>01205         Kdr = m_Kd[r];
<a name="l01206"></a>01206         a0 = (sm_T5[(t0 &gt;&gt; 24) &amp; 0xFF] ^
<a name="l01207"></a>01207               sm_T6[(t3 &gt;&gt; 16) &amp; 0xFF] ^
<a name="l01208"></a>01208               sm_T7[(t2 &gt;&gt;  8) &amp; 0xFF] ^
<a name="l01209"></a>01209               sm_T8[ t1        &amp; 0xFF]) ^ Kdr[0];
<a name="l01210"></a>01210         a1 = (sm_T5[(t1 &gt;&gt; 24) &amp; 0xFF] ^
<a name="l01211"></a>01211               sm_T6[(t0 &gt;&gt; 16) &amp; 0xFF] ^
<a name="l01212"></a>01212               sm_T7[(t3 &gt;&gt;  8) &amp; 0xFF] ^
<a name="l01213"></a>01213               sm_T8[ t2        &amp; 0xFF]) ^ Kdr[1];
<a name="l01214"></a>01214         a2 = (sm_T5[(t2 &gt;&gt; 24) &amp; 0xFF] ^
<a name="l01215"></a>01215               sm_T6[(t1 &gt;&gt; 16) &amp; 0xFF] ^
<a name="l01216"></a>01216               sm_T7[(t0 &gt;&gt;  8) &amp; 0xFF] ^
<a name="l01217"></a>01217               sm_T8[ t3        &amp; 0xFF]) ^ Kdr[2];
<a name="l01218"></a>01218         a3 = (sm_T5[(t3 &gt;&gt; 24) &amp; 0xFF] ^
<a name="l01219"></a>01219               sm_T6[(t2 &gt;&gt; 16) &amp; 0xFF] ^
<a name="l01220"></a>01220               sm_T7[(t1 &gt;&gt;  8) &amp; 0xFF] ^
<a name="l01221"></a>01221               sm_T8[ t0        &amp; 0xFF]) ^ Kdr[3];
<a name="l01222"></a>01222         t0 = a0;
<a name="l01223"></a>01223         t1 = a1;
<a name="l01224"></a>01224         t2 = a2;
<a name="l01225"></a>01225         t3 = a3;
<a name="l01226"></a>01226     }
<a name="l01227"></a>01227 
<a name="l01228"></a>01228     Kdr = m_Kd[m_iROUNDS];
<a name="l01229"></a>01229     <span class="keywordtype">int</span> tt = Kdr[0];
<a name="l01230"></a>01230     result[ 0] = sm_Si[(t0 &gt;&gt; 24) &amp; 0xFF] ^(tt &gt;&gt; 24);
<a name="l01231"></a>01231     result[ 1] = sm_Si[(t3 &gt;&gt; 16) &amp; 0xFF] ^(tt &gt;&gt; 16);
<a name="l01232"></a>01232     result[ 2] = sm_Si[(t2 &gt;&gt;  8) &amp; 0xFF] ^(tt &gt;&gt;  8);
<a name="l01233"></a>01233     result[ 3] = sm_Si[ t1 &amp; 0xFF] ^ tt;
<a name="l01234"></a>01234     tt = Kdr[1];
<a name="l01235"></a>01235     result[ 4] = sm_Si[(t1 &gt;&gt; 24) &amp; 0xFF] ^(tt &gt;&gt; 24);
<a name="l01236"></a>01236     result[ 5] = sm_Si[(t0 &gt;&gt; 16) &amp; 0xFF] ^(tt &gt;&gt; 16);
<a name="l01237"></a>01237     result[ 6] = sm_Si[(t3 &gt;&gt;  8) &amp; 0xFF] ^(tt &gt;&gt;  8);
<a name="l01238"></a>01238     result[ 7] = sm_Si[ t2 &amp; 0xFF] ^ tt;
<a name="l01239"></a>01239     tt = Kdr[2];
<a name="l01240"></a>01240     result[ 8] = sm_Si[(t2 &gt;&gt; 24) &amp; 0xFF] ^(tt &gt;&gt; 24);
<a name="l01241"></a>01241     result[ 9] = sm_Si[(t1 &gt;&gt; 16) &amp; 0xFF] ^(tt &gt;&gt; 16);
<a name="l01242"></a>01242     result[10] = sm_Si[(t0 &gt;&gt;  8) &amp; 0xFF] ^(tt &gt;&gt;  8);
<a name="l01243"></a>01243     result[11] = sm_Si[ t3 &amp; 0xFF] ^ tt;
<a name="l01244"></a>01244     tt = Kdr[3];
<a name="l01245"></a>01245     result[12] = sm_Si[(t3 &gt;&gt; 24) &amp; 0xFF] ^(tt &gt;&gt; 24);
<a name="l01246"></a>01246     result[13] = sm_Si[(t2 &gt;&gt; 16) &amp; 0xFF] ^(tt &gt;&gt; 16);
<a name="l01247"></a>01247     result[14] = sm_Si[(t1 &gt;&gt;  8) &amp; 0xFF] ^(tt &gt;&gt;  8);
<a name="l01248"></a>01248     result[15] = sm_Si[ t0 &amp; 0xFF] ^ tt;
<a name="l01249"></a>01249 }
<a name="l01250"></a>01250 
<a name="l01251"></a>01251 
<a name="l01252"></a><a class="code" href="../../d3/d1d/class_encoder.html#a452f3f41a148a4d059f0f2e0a516094a">01252</a> <span class="keywordtype">void</span> <a class="code" href="../../d3/d1d/class_encoder.html#a452f3f41a148a4d059f0f2e0a516094a">Encoder::EncryptBlock</a>(<span class="keywordtype">char</span> <span class="keyword">const</span>* in, <span class="keywordtype">char</span>* result)
<a name="l01253"></a>01253 {
<a name="l01254"></a>01254     <span class="keywordflow">if</span>(<span class="keyword">false</span> == m_bKeyInit)
<a name="l01255"></a>01255     {
<a name="l01256"></a>01256         <span class="keywordflow">throw</span> exception();
<a name="l01257"></a>01257     }
<a name="l01258"></a>01258 
<a name="l01259"></a>01259     <span class="keywordflow">if</span>(DEFAULT_BLOCK_SIZE == m_blockSize)
<a name="l01260"></a>01260     {
<a name="l01261"></a>01261         DefEncryptBlock(in, result);
<a name="l01262"></a>01262         <span class="keywordflow">return</span>;
<a name="l01263"></a>01263     }
<a name="l01264"></a>01264 
<a name="l01265"></a>01265     <span class="keywordtype">int</span> BC = m_blockSize / 4;
<a name="l01266"></a>01266     <span class="keywordtype">int</span> SC = (BC == 4) ? 0 : (BC == 6 ? 1 : 2);
<a name="l01267"></a>01267     <span class="keywordtype">int</span> s1 = sm_shifts[SC][1][0];
<a name="l01268"></a>01268     <span class="keywordtype">int</span> s2 = sm_shifts[SC][2][0];
<a name="l01269"></a>01269     <span class="keywordtype">int</span> s3 = sm_shifts[SC][3][0];
<a name="l01270"></a>01270     <span class="keywordtype">int</span> i;
<a name="l01271"></a>01271     <span class="keywordtype">int</span> tt;
<a name="l01272"></a>01272     <span class="keywordtype">int</span>* pi = t;
<a name="l01273"></a>01273 
<a name="l01274"></a>01274     <span class="keywordflow">for</span>(i = 0; i &lt; BC; i++)
<a name="l01275"></a>01275     {
<a name="l01276"></a>01276         *pi = ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 24);
<a name="l01277"></a>01277         *pi |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 16);
<a name="l01278"></a>01278         *pi |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 8);
<a name="l01279"></a>01279         (*(pi++) |= (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) * (in++)) ^= m_Ke[0][i];
<a name="l01280"></a>01280     }
<a name="l01281"></a>01281 
<a name="l01282"></a>01282     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r = 1; r &lt; m_iROUNDS; r++)
<a name="l01283"></a>01283     {
<a name="l01284"></a>01284         <span class="keywordflow">for</span>(i = 0; i &lt; BC; i++)
<a name="l01285"></a>01285             a[i] = (sm_T1[(t[i] &gt;&gt; 24) &amp; 0xFF] ^
<a name="l01286"></a>01286                     sm_T2[(t[(i + s1) % BC] &gt;&gt; 16) &amp; 0xFF] ^
<a name="l01287"></a>01287                     sm_T3[(t[(i + s2) % BC] &gt;&gt;  8) &amp; 0xFF] ^
<a name="l01288"></a>01288                     sm_T4[ t[(i + s3) % BC] &amp; 0xFF]) ^ m_Ke[r][i];
<a name="l01289"></a>01289 
<a name="l01290"></a>01290         memcpy(t, a, 4 * BC);
<a name="l01291"></a>01291     }
<a name="l01292"></a>01292 
<a name="l01293"></a>01293     <span class="keywordtype">int</span> j;
<a name="l01294"></a>01294 
<a name="l01295"></a>01295     <span class="keywordflow">for</span>(i = 0, j = 0; i &lt; BC; i++)
<a name="l01296"></a>01296     {
<a name="l01297"></a>01297         tt = m_Ke[m_iROUNDS][i];
<a name="l01298"></a>01298         result[j++] = sm_S[(t[i] &gt;&gt; 24) &amp; 0xFF] ^(tt &gt;&gt; 24);
<a name="l01299"></a>01299         result[j++] = sm_S[(t[(i + s1) % BC] &gt;&gt; 16) &amp; 0xFF] ^(tt &gt;&gt; 16);
<a name="l01300"></a>01300         result[j++] = sm_S[(t[(i + s2) % BC] &gt;&gt;  8) &amp; 0xFF] ^(tt &gt;&gt;  8);
<a name="l01301"></a>01301         result[j++] = sm_S[ t[(i + s3) % BC] &amp; 0xFF] ^ tt;
<a name="l01302"></a>01302     }
<a name="l01303"></a>01303 }
<a name="l01304"></a>01304 
<a name="l01305"></a>01305 
<a name="l01306"></a><a class="code" href="../../d3/d1d/class_encoder.html#a270b3a3f0d7a70b5be9df441a0462d83">01306</a> <span class="keywordtype">void</span> <a class="code" href="../../d3/d1d/class_encoder.html#a270b3a3f0d7a70b5be9df441a0462d83">Encoder::DecryptBlock</a>(<span class="keywordtype">char</span> <span class="keyword">const</span>* in, <span class="keywordtype">char</span>* result)
<a name="l01307"></a>01307 {
<a name="l01308"></a>01308     <span class="keywordflow">if</span>(<span class="keyword">false</span> == m_bKeyInit)
<a name="l01309"></a>01309     {
<a name="l01310"></a>01310         <span class="keywordflow">throw</span> exception();
<a name="l01311"></a>01311     }
<a name="l01312"></a>01312 
<a name="l01313"></a>01313     <span class="keywordflow">if</span>(DEFAULT_BLOCK_SIZE == m_blockSize)
<a name="l01314"></a>01314     {
<a name="l01315"></a>01315         DefDecryptBlock(in, result);
<a name="l01316"></a>01316         <span class="keywordflow">return</span>;
<a name="l01317"></a>01317     }
<a name="l01318"></a>01318 
<a name="l01319"></a>01319     <span class="keywordtype">int</span> BC = m_blockSize / 4;
<a name="l01320"></a>01320     <span class="keywordtype">int</span> SC = BC == 4 ? 0 : (BC == 6 ? 1 : 2);
<a name="l01321"></a>01321     <span class="keywordtype">int</span> s1 = sm_shifts[SC][1][1];
<a name="l01322"></a>01322     <span class="keywordtype">int</span> s2 = sm_shifts[SC][2][1];
<a name="l01323"></a>01323     <span class="keywordtype">int</span> s3 = sm_shifts[SC][3][1];
<a name="l01324"></a>01324     <span class="keywordtype">int</span> i;
<a name="l01325"></a>01325     <span class="keywordtype">int</span> tt;
<a name="l01326"></a>01326     <span class="keywordtype">int</span>* pi = t;
<a name="l01327"></a>01327 
<a name="l01328"></a>01328     <span class="keywordflow">for</span>(i = 0; i &lt; BC; i++)
<a name="l01329"></a>01329     {
<a name="l01330"></a>01330         *pi = ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 24);
<a name="l01331"></a>01331         *pi |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 16);
<a name="l01332"></a>01332         *pi |= ((<span class="keywordtype">unsigned</span> char) * (in++) &lt;&lt; 8);
<a name="l01333"></a>01333         (*(pi++) |= (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) * (in++)) ^= m_Kd[0][i];
<a name="l01334"></a>01334     }
<a name="l01335"></a>01335 
<a name="l01336"></a>01336     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r = 1; r &lt; m_iROUNDS; r++)
<a name="l01337"></a>01337     {
<a name="l01338"></a>01338         <span class="keywordflow">for</span>(i = 0; i &lt; BC; i++)
<a name="l01339"></a>01339             a[i] = (sm_T5[(t[i] &gt;&gt; 24) &amp; 0xFF] ^
<a name="l01340"></a>01340                     sm_T6[(t[(i + s1) % BC] &gt;&gt; 16) &amp; 0xFF] ^
<a name="l01341"></a>01341                     sm_T7[(t[(i + s2) % BC] &gt;&gt;  8) &amp; 0xFF] ^
<a name="l01342"></a>01342                     sm_T8[ t[(i + s3) % BC] &amp; 0xFF]) ^ m_Kd[r][i];
<a name="l01343"></a>01343 
<a name="l01344"></a>01344         memcpy(t, a, 4 * BC);
<a name="l01345"></a>01345     }
<a name="l01346"></a>01346 
<a name="l01347"></a>01347     <span class="keywordtype">int</span> j;
<a name="l01348"></a>01348 
<a name="l01349"></a>01349     <span class="keywordflow">for</span>(i = 0, j = 0; i &lt; BC; i++)
<a name="l01350"></a>01350     {
<a name="l01351"></a>01351         tt = m_Kd[m_iROUNDS][i];
<a name="l01352"></a>01352         result[j++] = sm_Si[(t[i] &gt;&gt; 24) &amp; 0xFF] ^(tt &gt;&gt; 24);
<a name="l01353"></a>01353         result[j++] = sm_Si[(t[(i + s1) % BC] &gt;&gt; 16) &amp; 0xFF] ^(tt &gt;&gt; 16);
<a name="l01354"></a>01354         result[j++] = sm_Si[(t[(i + s2) % BC] &gt;&gt;  8) &amp; 0xFF] ^(tt &gt;&gt;  8);
<a name="l01355"></a>01355         result[j++] = sm_Si[ t[(i + s3) % BC] &amp; 0xFF] ^ tt;
<a name="l01356"></a>01356     }
<a name="l01357"></a>01357 }
<a name="l01358"></a>01358 
<a name="l01359"></a><a class="code" href="../../d3/d1d/class_encoder.html#abcc6da65eaa4c96f3b22c1d17dd0964c">01359</a> <span class="keywordtype">void</span> <a class="code" href="../../d3/d1d/class_encoder.html#abcc6da65eaa4c96f3b22c1d17dd0964c">Encoder::Encrypt</a>(<span class="keywordtype">char</span> <span class="keyword">const</span>* in, <span class="keywordtype">char</span>* result, <span class="keywordtype">size_t</span> n, <span class="keywordtype">int</span> iMode)
<a name="l01360"></a>01360 {
<a name="l01361"></a>01361     <span class="keywordflow">if</span>(<span class="keyword">false</span> == m_bKeyInit)
<a name="l01362"></a>01362     {
<a name="l01363"></a>01363         <span class="keywordflow">throw</span> exception();
<a name="l01364"></a>01364     }
<a name="l01365"></a>01365 
<a name="l01366"></a>01366     <span class="keywordflow">if</span>(0 == n || n % m_blockSize != 0)
<a name="l01367"></a>01367     {
<a name="l01368"></a>01368         <span class="keywordflow">throw</span> exception();
<a name="l01369"></a>01369     }
<a name="l01370"></a>01370 
<a name="l01371"></a>01371     <span class="keywordtype">int</span> i;
<a name="l01372"></a>01372     <span class="keywordtype">char</span> <span class="keyword">const</span>* pin;
<a name="l01373"></a>01373     <span class="keywordtype">char</span>* presult;
<a name="l01374"></a>01374 
<a name="l01375"></a>01375     <span class="keywordflow">if</span>(<a class="code" href="../../d3/d1d/class_encoder.html#a10508c39d42f4921352bb68e934900ddaa8609a270a0ef8b0e66cb1d4d075a875">CBC</a> == iMode)
<a name="l01376"></a>01376     {
<a name="l01377"></a>01377         <span class="keywordflow">for</span>(i = 0, pin = in, presult = result; i &lt; (int)(n / m_blockSize); i++)
<a name="l01378"></a>01378         {
<a name="l01379"></a>01379             Xor(m_chain, pin);
<a name="l01380"></a>01380             <a class="code" href="../../d3/d1d/class_encoder.html#a452f3f41a148a4d059f0f2e0a516094a">EncryptBlock</a>(m_chain, presult);
<a name="l01381"></a>01381             memcpy(m_chain, presult, m_blockSize);
<a name="l01382"></a>01382             pin += m_blockSize;
<a name="l01383"></a>01383             presult += m_blockSize;
<a name="l01384"></a>01384         }
<a name="l01385"></a>01385     }
<a name="l01386"></a>01386     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d3/d1d/class_encoder.html#a10508c39d42f4921352bb68e934900dda0d71a912b3259fb2bb23f16f50b166f1">CFB</a> == iMode)
<a name="l01387"></a>01387     {
<a name="l01388"></a>01388         <span class="keywordflow">for</span>(i = 0, pin = in, presult = result; i &lt; (int)(n / m_blockSize); i++)
<a name="l01389"></a>01389         {
<a name="l01390"></a>01390             <a class="code" href="../../d3/d1d/class_encoder.html#a452f3f41a148a4d059f0f2e0a516094a">EncryptBlock</a>(m_chain, presult);
<a name="l01391"></a>01391             Xor(presult, pin);
<a name="l01392"></a>01392             memcpy(m_chain, presult, m_blockSize);
<a name="l01393"></a>01393             pin += m_blockSize;
<a name="l01394"></a>01394             presult += m_blockSize;
<a name="l01395"></a>01395         }
<a name="l01396"></a>01396     }
<a name="l01397"></a>01397     <span class="keywordflow">else</span>
<a name="l01398"></a>01398     {
<a name="l01399"></a>01399         <span class="keywordflow">for</span>(i = 0, pin = in, presult = result; i &lt; (int)(n / m_blockSize); i++)
<a name="l01400"></a>01400         {
<a name="l01401"></a>01401             <a class="code" href="../../d3/d1d/class_encoder.html#a452f3f41a148a4d059f0f2e0a516094a">EncryptBlock</a>(pin, presult);
<a name="l01402"></a>01402             pin += m_blockSize;
<a name="l01403"></a>01403             presult += m_blockSize;
<a name="l01404"></a>01404         }
<a name="l01405"></a>01405     }
<a name="l01406"></a>01406 }
<a name="l01407"></a>01407 
<a name="l01408"></a><a class="code" href="../../d3/d1d/class_encoder.html#a25171748c8c9ea9413efc377630cb675">01408</a> <span class="keywordtype">void</span> <a class="code" href="../../d3/d1d/class_encoder.html#a25171748c8c9ea9413efc377630cb675">Encoder::Decrypt</a>(<span class="keywordtype">char</span> <span class="keyword">const</span>* in, <span class="keywordtype">char</span>* result, <span class="keywordtype">size_t</span> n, <span class="keywordtype">int</span> iMode)
<a name="l01409"></a>01409 {
<a name="l01410"></a>01410     <span class="keywordflow">if</span>(<span class="keyword">false</span> == m_bKeyInit)
<a name="l01411"></a>01411     {
<a name="l01412"></a>01412         <span class="keywordflow">throw</span> exception();
<a name="l01413"></a>01413     }
<a name="l01414"></a>01414 
<a name="l01415"></a>01415     <span class="keywordflow">if</span>(0 == n || n % m_blockSize != 0)
<a name="l01416"></a>01416     {
<a name="l01417"></a>01417         <span class="keywordflow">throw</span> exception();
<a name="l01418"></a>01418     }
<a name="l01419"></a>01419 
<a name="l01420"></a>01420     <span class="keywordtype">int</span> i;
<a name="l01421"></a>01421     <span class="keywordtype">char</span> <span class="keyword">const</span>* pin;
<a name="l01422"></a>01422     <span class="keywordtype">char</span>* presult;
<a name="l01423"></a>01423 
<a name="l01424"></a>01424     <span class="keywordflow">if</span>(<a class="code" href="../../d3/d1d/class_encoder.html#a10508c39d42f4921352bb68e934900ddaa8609a270a0ef8b0e66cb1d4d075a875">CBC</a> == iMode)
<a name="l01425"></a>01425     {
<a name="l01426"></a>01426         <span class="keywordflow">for</span>(i = 0, pin = in, presult = result; i &lt; (int)(n / m_blockSize); i++)
<a name="l01427"></a>01427         {
<a name="l01428"></a>01428             <a class="code" href="../../d3/d1d/class_encoder.html#a270b3a3f0d7a70b5be9df441a0462d83">DecryptBlock</a>(pin, presult);
<a name="l01429"></a>01429             Xor(presult, m_chain);
<a name="l01430"></a>01430             memcpy(m_chain, pin, m_blockSize);
<a name="l01431"></a>01431             pin += m_blockSize;
<a name="l01432"></a>01432             presult += m_blockSize;
<a name="l01433"></a>01433         }
<a name="l01434"></a>01434     }
<a name="l01435"></a>01435     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d3/d1d/class_encoder.html#a10508c39d42f4921352bb68e934900dda0d71a912b3259fb2bb23f16f50b166f1">CFB</a> == iMode)
<a name="l01436"></a>01436     {
<a name="l01437"></a>01437         <span class="keywordflow">for</span>(i = 0, pin = in, presult = result; i &lt; (int)(n / m_blockSize); i++)
<a name="l01438"></a>01438         {
<a name="l01439"></a>01439             <a class="code" href="../../d3/d1d/class_encoder.html#a452f3f41a148a4d059f0f2e0a516094a">EncryptBlock</a>(m_chain, presult);
<a name="l01440"></a>01440             Xor(presult, pin);
<a name="l01441"></a>01441             memcpy(m_chain, pin, m_blockSize);
<a name="l01442"></a>01442             pin += m_blockSize;
<a name="l01443"></a>01443             presult += m_blockSize;
<a name="l01444"></a>01444         }
<a name="l01445"></a>01445     }
<a name="l01446"></a>01446     <span class="keywordflow">else</span>
<a name="l01447"></a>01447     {
<a name="l01448"></a>01448         <span class="keywordflow">for</span>(i = 0, pin = in, presult = result; i &lt; (int)(n / m_blockSize); i++)
<a name="l01449"></a>01449         {
<a name="l01450"></a>01450             <a class="code" href="../../d3/d1d/class_encoder.html#a270b3a3f0d7a70b5be9df441a0462d83">DecryptBlock</a>(pin, presult);
<a name="l01451"></a>01451             pin += m_blockSize;
<a name="l01452"></a>01452             presult += m_blockSize;
<a name="l01453"></a>01453         }
<a name="l01454"></a>01454     }
<a name="l01455"></a>01455 }
<a name="l01456"></a>01456 
<a name="l01457"></a>01457 
<a name="l01458"></a><a class="code" href="../../d3/d1d/class_encoder.html#afa51698f8ac756bafc5cb2a4dfbf4c8d">01458</a> <span class="keywordtype">void</span> <a class="code" href="../../d3/d1d/class_encoder.html#afa51698f8ac756bafc5cb2a4dfbf4c8d">Encoder::crc16_init</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>* uCrc16)
<a name="l01459"></a>01459 {
<a name="l01460"></a>01460     *uCrc16 = 0xFFFF;
<a name="l01461"></a>01461 }
<a name="l01462"></a>01462 
<a name="l01463"></a><a class="code" href="../../d3/d1d/class_encoder.html#a6f7edc193626f793f309821661fb663a">01463</a> <span class="keywordtype">void</span> <a class="code" href="../../d3/d1d/class_encoder.html#a6f7edc193626f793f309821661fb663a">Encoder::crc16_update</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>* uCrc16, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* pBuffer, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> uBufSize)
<a name="l01464"></a>01464 {
<a name="l01465"></a>01465     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i = 0;
<a name="l01466"></a>01466 
<a name="l01467"></a>01467     <span class="keywordflow">for</span>(i = 0; i &lt; uBufSize; i++)
<a name="l01468"></a>01468     {
<a name="l01469"></a>01469         *uCrc16 = (*uCrc16 &gt;&gt; 8) ^ crc16tab[(*uCrc16 ^ *pBuffer++) &amp; 0xFF];
<a name="l01470"></a>01470     }
<a name="l01471"></a>01471 }
<a name="l01472"></a>01472 
<a name="l01473"></a><a class="code" href="../../d3/d1d/class_encoder.html#a37fee3f3d59fe9151511a0cd8f3e76a0">01473</a> <span class="keywordtype">void</span> <a class="code" href="../../d3/d1d/class_encoder.html#a37fee3f3d59fe9151511a0cd8f3e76a0">Encoder::crc16_final</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>* uCrc16)
<a name="l01474"></a>01474 {
<a name="l01475"></a>01475     *uCrc16 = ~(*uCrc16);
<a name="l01476"></a>01476 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全部</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>类</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>文件</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>函数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>变量</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>类型定义</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>枚举</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>枚举值</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>宏定义</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated at 2012年二月1日 星期三 11:21:40 for nnr by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
